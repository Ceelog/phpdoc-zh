Quickhash
=========

**目录**

-   [简介](/intro/quickhash.html)
-   [安装／配置](/quickhash/setup.html)
    -   [需求](/quickhash/setup.html#需求)
    -   [安装](/quickhash/setup.html#安装)
    -   [运行时配置](/quickhash/setup.html#运行时配置)
-   [预定义常量](/quickhash/constants.html)
-   [范例](/quickhash/examples.html)
-   [QuickHashIntSet](/class/quickhashintset.html) — The QuickHashIntSet
    class
    -   [QuickHashIntSet::add](/class/quickhashintset.html#QuickHashIntSet::add)
        — This method adds a new entry to the set
    -   [QuickHashIntSet::\_\_construct](/class/quickhashintset.html#QuickHashIntSet::__construct)
        — Creates a new QuickHashIntSet object
    -   [QuickHashIntSet::delete](/class/quickhashintset.html#QuickHashIntSet::delete)
        — This method deletes an entry from the set
    -   [QuickHashIntSet::exists](/class/quickhashintset.html#QuickHashIntSet::exists)
        — This method checks whether a key is part of the set
    -   [QuickHashIntSet::getSize](/class/quickhashintset.html#QuickHashIntSet::getSize)
        — Returns the number of elements in the set
    -   [QuickHashIntSet::loadFromFile](/class/quickhashintset.html#QuickHashIntSet::loadFromFile)
        — This factory method creates a set from a file
    -   [QuickHashIntSet::loadFromString](/class/quickhashintset.html#QuickHashIntSet::loadFromString)
        — This factory method creates a set from a string
    -   [QuickHashIntSet::saveToFile](/class/quickhashintset.html#QuickHashIntSet::saveToFile)
        — This method stores an in-memory set to disk
    -   [QuickHashIntSet::saveToString](/class/quickhashintset.html#QuickHashIntSet::saveToString)
        — This method returns a serialized version of the set
-   [QuickHashIntHash](/class/quickhashinthash.html) — The
    QuickHashIntHash class
    -   [QuickHashIntHash::add](/class/quickhashinthash.html#QuickHashIntHash::add)
        — This method adds a new entry to the hash
    -   [QuickHashIntHash::\_\_construct](/class/quickhashinthash.html#QuickHashIntHash::__construct)
        — Creates a new QuickHashIntHash object
    -   [QuickHashIntHash::delete](/class/quickhashinthash.html#QuickHashIntHash::delete)
        — This method deletes am entry from the hash
    -   [QuickHashIntHash::exists](/class/quickhashinthash.html#QuickHashIntHash::exists)
        — This method checks whether a key is part of the hash
    -   [QuickHashIntHash::get](/class/quickhashinthash.html#QuickHashIntHash::get)
        — This method retrieves a value from the hash by its key
    -   [QuickHashIntHash::getSize](/class/quickhashinthash.html#QuickHashIntHash::getSize)
        — Returns the number of elements in the hash
    -   [QuickHashIntHash::loadFromFile](/class/quickhashinthash.html#QuickHashIntHash::loadFromFile)
        — This factory method creates a hash from a file
    -   [QuickHashIntHash::loadFromString](/class/quickhashinthash.html#QuickHashIntHash::loadFromString)
        — This factory method creates a hash from a string
    -   [QuickHashIntHash::saveToFile](/class/quickhashinthash.html#QuickHashIntHash::saveToFile)
        — This method stores an in-memory hash to disk
    -   [QuickHashIntHash::saveToString](/class/quickhashinthash.html#QuickHashIntHash::saveToString)
        — This method returns a serialized version of the hash
    -   [QuickHashIntHash::set](/class/quickhashinthash.html#QuickHashIntHash::set)
        — This method updates an entry in the hash with a new value, or
        adds a new one if the entry doesn't exist
    -   [QuickHashIntHash::update](/class/quickhashinthash.html#QuickHashIntHash::update)
        — This method updates an entry in the hash with a new value
-   [QuickHashStringIntHash](/class/quickhashstringinthash.html) — The
    QuickHashStringIntHash class
    -   [QuickHashStringIntHash::add](/class/quickhashstringinthash.html#QuickHashStringIntHash::add)
        — This method adds a new entry to the hash
    -   [QuickHashStringIntHash::\_\_construct](/class/quickhashstringinthash.html#QuickHashStringIntHash::__construct)
        — Creates a new QuickHashStringIntHash object
    -   [QuickHashStringIntHash::delete](/class/quickhashstringinthash.html#QuickHashStringIntHash::delete)
        — This method deletes am entry from the hash
    -   [QuickHashStringIntHash::exists](/class/quickhashstringinthash.html#QuickHashStringIntHash::exists)
        — This method checks whether a key is part of the hash
    -   [QuickHashStringIntHash::get](/class/quickhashstringinthash.html#QuickHashStringIntHash::get)
        — This method retrieves a value from the hash by its key
    -   [QuickHashStringIntHash::getSize](/class/quickhashstringinthash.html#QuickHashStringIntHash::getSize)
        — Returns the number of elements in the hash
    -   [QuickHashStringIntHash::loadFromFile](/class/quickhashstringinthash.html#QuickHashStringIntHash::loadFromFile)
        — This factory method creates a hash from a file
    -   [QuickHashStringIntHash::loadFromString](/class/quickhashstringinthash.html#QuickHashStringIntHash::loadFromString)
        — This factory method creates a hash from a string
    -   [QuickHashStringIntHash::saveToFile](/class/quickhashstringinthash.html#QuickHashStringIntHash::saveToFile)
        — This method stores an in-memory hash to disk
    -   [QuickHashStringIntHash::saveToString](/class/quickhashstringinthash.html#QuickHashStringIntHash::saveToString)
        — This method returns a serialized version of the hash
    -   [QuickHashStringIntHash::set](/class/quickhashstringinthash.html#QuickHashStringIntHash::set)
        — This method updates an entry in the hash with a new value, or
        adds a new one if the entry doesn't exist
    -   [QuickHashStringIntHash::update](/class/quickhashstringinthash.html#QuickHashStringIntHash::update)
        — This method updates an entry in the hash with a new value
-   [QuickHashIntStringHash](/class/quickhashintstringhash.html) — The
    QuickHashIntStringHash class
    -   [QuickHashIntStringHash::add](/class/quickhashintstringhash.html#QuickHashIntStringHash::add)
        — This method adds a new entry to the hash
    -   [QuickHashIntStringHash::\_\_construct](/class/quickhashintstringhash.html#QuickHashIntStringHash::__construct)
        — Creates a new QuickHashIntStringHash object
    -   [QuickHashIntStringHash::delete](/class/quickhashintstringhash.html#QuickHashIntStringHash::delete)
        — This method deletes am entry from the hash
    -   [QuickHashIntStringHash::exists](/class/quickhashintstringhash.html#QuickHashIntStringHash::exists)
        — This method checks whether a key is part of the hash
    -   [QuickHashIntStringHash::get](/class/quickhashintstringhash.html#QuickHashIntStringHash::get)
        — This method retrieves a value from the hash by its key
    -   [QuickHashIntStringHash::getSize](/class/quickhashintstringhash.html#QuickHashIntStringHash::getSize)
        — Returns the number of elements in the hash
    -   [QuickHashIntStringHash::loadFromFile](/class/quickhashintstringhash.html#QuickHashIntStringHash::loadFromFile)
        — This factory method creates a hash from a file
    -   [QuickHashIntStringHash::loadFromString](/class/quickhashintstringhash.html#QuickHashIntStringHash::loadFromString)
        — This factory method creates a hash from a string
    -   [QuickHashIntStringHash::saveToFile](/class/quickhashintstringhash.html#QuickHashIntStringHash::saveToFile)
        — This method stores an in-memory hash to disk
    -   [QuickHashIntStringHash::saveToString](/class/quickhashintstringhash.html#QuickHashIntStringHash::saveToString)
        — This method returns a serialized version of the hash
    -   [QuickHashIntStringHash::set](/class/quickhashintstringhash.html#QuickHashIntStringHash::set)
        — This method updates an entry in the hash with a new value, or
        adds a new one if the entry doesn't exist
    -   [QuickHashIntStringHash::update](/class/quickhashintstringhash.html#QuickHashIntStringHash::update)
        — This method updates an entry in the hash with a new value

简介
----

This class wraps around a set containing integer numbers.

Sets can also be iterated over with foreach as the Iterator interface is
implemented as well. The order of which elements are returned in is not
guaranteed.

类摘要
------

**QuickHashIntSet**

<span class="ooclass"> class **QuickHashIntSet** </span> {

/\* Constants \*/

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntSet::CHECK_FOR_DUPES` <span class="initializer"> = 1</span>
;

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntSet::DO_NOT_USE_ZEND_ALLOC` <span class="initializer"> =
2</span> ;

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntSet::HASHER_NO_HASH` <span class="initializer"> =
256</span> ;

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntSet::HASHER_JENKINS1` <span class="initializer"> =
512</span> ;

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntSet::HASHER_JENKINS2` <span class="initializer"> =
1024</span> ;

/\* Methods \*/

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">add</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> )

<span class="modifier">public</span> <span
class="methodname">\_\_construct</span> ( <span
class="methodparam"><span class="type">int</span> `$size`</span> \[,
<span class="methodparam"><span class="type">int</span>
`$options`</span> \] )

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">delete</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> )

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">exists</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> )

<span class="modifier">public</span><span class="type">int</span> <span
class="methodname">getSize</span> ( <span
class="methodparam">void</span> )

<span class="modifier">public</span> <span
class="modifier">static</span> <span class="type">QuickHashIntSet</span>
<span class="methodname">loadFromFile</span> ( <span
class="methodparam"><span class="type">string</span> `$filename`</span>
\[, <span class="methodparam"><span class="type">int</span>
`$size`</span> \[, <span class="methodparam"><span
class="type">int</span> `$options`</span> \]\] )

<span class="modifier">public</span> <span
class="modifier">static</span> <span class="type">QuickHashIntSet</span>
<span class="methodname">loadFromString</span> ( <span
class="methodparam"><span class="type">string</span> `$contents`</span>
\[, <span class="methodparam"><span class="type">int</span>
`$size`</span> \[, <span class="methodparam"><span
class="type">int</span> `$options`</span> \]\] )

<span class="modifier">public</span> <span class="type">void</span>
<span class="methodname">saveToFile</span> ( <span
class="methodparam"><span class="type">string</span> `$filename`</span>
)

<span class="modifier">public</span> <span class="type">string</span>
<span class="methodname">saveToString</span> ( <span
class="methodparam">void</span> )

}

预定义常量
----------

**`QuickHashIntSet::CHECK_FOR_DUPES`**  
If enabled, adding duplicate elements to a set (through either add() or
loadFromFile()) will result in those elements to be dropped from the
set. This will take up extra time, so only used when it is required.

**`QuickHashIntSet::DO_NOT_USE_ZEND_ALLOC`**  
Disables the use of PHP's internal memory manager for internal set
structures. With this option enabled, internal allocations will not
count towards the memory\_limit settings.

**`QuickHashIntSet::HASHER_NO_HASH`**  
Selects to not use a hashing function, but merely use a modulo to find
the bucket list index. This is not faster than normal hashing, and gives
more collisions.

**`QuickHashIntSet::HASHER_JENKINS1`**  
This is the default hashing function to turn the integer hashes into
bucket list indexes.

**`QuickHashIntSet::HASHER_JENKINS2`**  
Selects a variant hashing algorithm.

QuickHashIntSet::add
====================

This method adds a new entry to the set

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashIntSet::add</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> )

This method adds a new entry to the set, and returns whether the entry
was added. Entries are by default always added unless
QuickHashIntSet::CHECK\_FOR\_DUPES has been passed when the set was
created.

### 参数

`key`  
The key of the entry to add.

### 返回值

**`TRUE`** when the entry was added, and **`FALSE`** if the entry was
not added.

### 范例

**示例 \#1 <span class="function">QuickHashIntSet::add</span> example**

``` php
<?php
echo "without dupe checking\n";
$set = new QuickHashIntSet( 1024 );
var_dump( $set->exists( 4 ) );
var_dump( $set->add( 4 ) );
var_dump( $set->exists( 4 ) );
var_dump( $set->add( 4 ) );

echo "\nwith dupe checking\n";
$set = new QuickHashIntSet( 1024, QuickHashIntSet::CHECK_FOR_DUPES );
var_dump( $set->exists( 4 ) );
var_dump( $set->add( 4 ) );
var_dump( $set->exists( 4 ) );
var_dump( $set->add( 4 ) );
?>
```

以上例程的输出类似于：

    without dupe checking
    bool(false)
    bool(true)
    bool(true)
    bool(true)

    with dupe checking
    bool(false)
    bool(true)
    bool(true)
    bool(false)

QuickHashIntSet::\_\_construct
==============================

Creates a new QuickHashIntSet object

### 说明

<span class="modifier">public</span> <span
class="methodname">QuickHashIntSet::\_\_construct</span> ( <span
class="methodparam"><span class="type">int</span> `$size`</span> \[,
<span class="methodparam"><span class="type">int</span>
`$options`</span> \] )

This constructor creates a new QuickHashIntSet. The size is the amount
of bucket lists to create. The more lists there are, the less collisions
you will have. Options are also supported.

### 参数

`size`  
The amount of bucket lists to configure. The number you pass in will be
automatically rounded up to the next power of two. It is also
automatically limited from 4 to 4194304.

`options`  
The options that you can pass in are:
QuickHashIntSet::CHECK\_FOR\_DUPES, which makes sure no duplicate
entries are added to the set; QuickHashIntSet::DO\_NOT\_USE\_ZEND\_ALLOC
to not use PHP's internal memory manager as well as one of
QuickHashIntSet::HASHER\_NO\_HASH, QuickHashIntSet::HASHER\_JENKINS1 or
QuickHashIntSet::HASHER\_JENKINS2. These last three configure which
hashing algorithm to use. All options can be combined using bitmasks.

### 返回值

Returns a new QuickHashIntSet object.

### 范例

**示例 \#1 <span class="function">QuickHashIntSet::\_\_construct</span>
example**

``` php
<?php
var_dump( new QuickHashIntSet( 1024 ) );
var_dump( new QuickHashIntSet( 1024, QuickHashIntSet::CHECK_FOR_DUPES ) );
var_dump(
    new QuickHashIntSet(
        1024,
        QuickHashIntSet::DO_NOT_USE_ZEND_ALLOC | QuickHashIntSet::HASHER_JENKINS2 
    )
);
?>
```

QuickHashIntSet::delete
=======================

This method deletes an entry from the set

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashIntSet::delete</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> )

This method deletes an entry from the set, and returns whether the entry
was deleted or not. Associated memory structures will not be freed
immediately, but rather when the set itself is freed.

### 参数

`key`  
The key of the entry to delete.

### 返回值

**`TRUE`** when the entry was deleted, and **`FALSE`** if the entry was
not deleted.

### 范例

**示例 \#1 <span class="function">QuickHashIntSet::delete</span>
example**

``` php
<?php
$set = new QuickHashIntSet( 1024 );
var_dump( $set->exists( 4 ) );
var_dump( $set->add( 4 ) );
var_dump( $set->delete( 4 ) );
var_dump( $set->exists( 4 ) );
var_dump( $set->delete( 4 ) );
?>
```

以上例程的输出类似于：

    bool(false)
    bool(true)
    bool(true)
    bool(false)
    bool(false)

QuickHashIntSet::exists
=======================

This method checks whether a key is part of the set

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashIntSet::exists</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> )

This method checks whether an entry with the provided key exists in the
set.

### 参数

`key`  
The key of the entry to check for whether it exists in the set.

### 返回值

Returns **`TRUE`** when the entry was found, or **`FALSE`** when the
entry is not found.

### 范例

**示例 \#1 <span class="function">QuickHashIntSet::exists</span>
example**

``` php
<?php
//generate 200000 elements
$array = range( 0, 199999 );
$existingEntries = array_rand( array_flip( $array ), 180000 );
$testForEntries = array_rand( array_flip( $array ), 1000 );
$foundCount = 0;

echo "Creating set: ", microtime( true ), "\n";
$set = new QuickHashIntSet( 100000 );
echo "Adding elements: ", microtime( true ), "\n";
foreach( $existingEntries as $key )
{
     $set->add( $key );
}

echo "Doing 1000 tests: ", microtime( true ), "\n";
foreach( $testForEntries as $key )
{
     $foundCount += $set->exists( $key );
}
echo "Done, $foundCount found: ", microtime( true ), "\n";
?>
```

以上例程的输出类似于：

    Creating set: 1263588703.0748
    Adding elements: 1263588703.0757
    Doing 1000 tests: 1263588703.7851
    Done, 898 found: 1263588703.7897

QuickHashIntSet::getSize
========================

Returns the number of elements in the set

### 说明

<span class="modifier">public</span><span class="type">int</span> <span
class="methodname">QuickHashIntSet::getSize</span> ( <span
class="methodparam">void</span> )

Returns the number of elements in the set.

### 参数

`key`  
The key of the entry to add.

### 返回值

The number of elements in the set.

### 范例

**示例 \#1 <span class="function">QuickHashIntSet::getSize</span>
example**

``` php
<?php
$set = new QuickHashIntSet( 8 );
var_dump( $set->add( 2 ) );
var_dump( $set->add( 3 ) );
var_dump( $set->getSize() );
?>
```

以上例程的输出类似于：

    bool(true)
    bool(true)
    int(2)

QuickHashIntSet::loadFromFile
=============================

This factory method creates a set from a file

### 说明

<span class="modifier">public</span> <span
class="modifier">static</span> <span class="type">QuickHashIntSet</span>
<span class="methodname">QuickHashIntSet::loadFromFile</span> ( <span
class="methodparam"><span class="type">string</span> `$filename`</span>
\[, <span class="methodparam"><span class="type">int</span>
`$size`</span> \[, <span class="methodparam"><span
class="type">int</span> `$options`</span> \]\] )

This factory method creates a new set from a definition file on disk.
The file format consists of 32 bit signed integers packed together in
the Endianness that the system that the code runs on uses.

### 参数

`filename`  
The filename of the file to read the set from.

`size`  
The amount of bucket lists to configure. The number you pass in will be
automatically rounded up to the next power of two. It is also
automatically limited from 4 to 4194304.

`options`  
The same options that the class' constructor takes; except that the size
option is ignored. It is automatically calculated to be the same as the
number of entries in the set, rounded up to the nearest power of two
with a maximum limit of 4194304.

### 返回值

Returns a new QuickHashIntSet.

### 范例

**示例 \#1 <span class="function">QuickHashIntSet::loadFromFile</span>
example**

``` php
<?php
$file = dirname( __FILE__ ) . "/simple.set";
$set = QuickHashIntSet::loadFromFile(
    $file,
    QuickHashIntSet::DO_NOT_USE_ZEND_ALLOC
);
foreach( range( 0, 0x0f ) as $key )
{
    printf( "Key %3d (%2x) is %s\n",
        $key, $key, 
        $set->exists( $key ) ? 'set' : 'unset'
    );
}
?>
```

以上例程的输出类似于：

    Key   0 ( 0) is unset
    Key   1 ( 1) is set
    Key   2 ( 2) is set
    Key   3 ( 3) is set
    Key   4 ( 4) is unset
    Key   5 ( 5) is set
    Key   6 ( 6) is unset
    Key   7 ( 7) is set
    Key   8 ( 8) is unset
    Key   9 ( 9) is unset
    Key  10 ( a) is unset
    Key  11 ( b) is set
    Key  12 ( c) is unset
    Key  13 ( d) is set
    Key  14 ( e) is unset
    Key  15 ( f) is unset

QuickHashIntSet::loadFromString
===============================

This factory method creates a set from a string

### 说明

<span class="modifier">public</span> <span
class="modifier">static</span> <span class="type">QuickHashIntSet</span>
<span class="methodname">QuickHashIntSet::loadFromString</span> ( <span
class="methodparam"><span class="type">string</span> `$contents`</span>
\[, <span class="methodparam"><span class="type">int</span>
`$size`</span> \[, <span class="methodparam"><span
class="type">int</span> `$options`</span> \]\] )

This factory method creates a new set from a definition in a string. The
file format consists of 32 bit signed integers packed together in the
Endianness that the system that the code runs on uses.

### 参数

`contents`  
The string containing a serialized format of the set.

`size`  
The amount of bucket lists to configure. The number you pass in will be
automatically rounded up to the next power of two. It is also
automatically limited from 4 to 4194304.

`options`  
The same options that the class' constructor takes; except that the size
option is ignored. It is automatically calculated to be the same as the
number of entries in the set, rounded up to the nearest power of two
automatically limited from 64 to 4194304.

### 返回值

Returns a new QuickHashIntSet.

### 范例

**示例 \#1 <span class="function">QuickHashIntSet::loadFromString</span>
example**

``` php
<?php
$contents = file_get_contents( dirname( __FILE__ ) . "/simple.set" );
$set = QuickHashIntSet::loadFromString(
    $contents,
    QuickHashIntSet::DO_NOT_USE_ZEND_ALLOC
);
foreach( range( 0, 0x0f ) as $key )
{
    printf( "Key %3d (%2x) is %s\n",
        $key, $key, 
        $set->exists( $key ) ? 'set' : 'unset'
    );
}
?>
```

以上例程的输出类似于：

    Key   0 ( 0) is unset
    Key   1 ( 1) is set
    Key   2 ( 2) is set
    Key   3 ( 3) is set
    Key   4 ( 4) is unset
    Key   5 ( 5) is set
    Key   6 ( 6) is unset
    Key   7 ( 7) is set
    Key   8 ( 8) is unset
    Key   9 ( 9) is unset
    Key  10 ( a) is unset
    Key  11 ( b) is set
    Key  12 ( c) is unset
    Key  13 ( d) is set
    Key  14 ( e) is unset
    Key  15 ( f) is unset

QuickHashIntSet::saveToFile
===========================

This method stores an in-memory set to disk

### 说明

<span class="modifier">public</span> <span class="type">void</span>
<span class="methodname">QuickHashIntSet::saveToFile</span> ( <span
class="methodparam"><span class="type">string</span> `$filename`</span>
)

This method stores an existing set to a file on disk, in the same format
that loadFromFile() can read.

### 参数

`filename`  
The filename of the file to store the hash in.

### 返回值

没有返回值。

### 范例

**示例 \#1 <span class="function">QuickHashIntSet::saveToFile</span>
example**

``` php
<?php
$set = new QuickHashIntSet( 1024 );
var_dump( $set->exists( 4 ) );
var_dump( $set->add( 4 ) );
var_dump( $set->exists( 4 ) );
var_dump( $set->add( 4 ) );

$set->saveToFile( '/tmp/test.set' );
?>
```

QuickHashIntSet::saveToString
=============================

This method returns a serialized version of the set

### 说明

<span class="modifier">public</span> <span class="type">string</span>
<span class="methodname">QuickHashIntSet::saveToString</span> ( <span
class="methodparam">void</span> )

This method returns a serialized version of the set in the same format
that loadFromString() can read.

### 返回值

This method returns a string containing a serialized format of the set.
Each element is stored as a four byte value in the Endianness that the
current system uses.

### 范例

**示例 \#1 <span class="function">QuickHashIntSet::saveToString</span>
example**

``` php
<?php
$set = new QuickHashIntSet( 1024 );
var_dump( $set->exists( 4 ) );
var_dump( $set->add( 4 ) );
var_dump( $set->exists( 4 ) );
var_dump( $set->add( 4 ) );

var_dump( $set->saveToString() );
?>
```

简介
----

This class wraps around a hash containing integer numbers, where the
values are also integer numbers. Hashes are also available as
implementation of the ArrayAccess interface.

Hashes can also be iterated over with foreach as the Iterator interface
is implemented as well. The order of which elements are returned in is
not guaranteed.

类摘要
------

**QuickHashIntHash**

<span class="ooclass"> class **QuickHashIntHash** </span> {

/\* Constants \*/

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntHash::CHECK_FOR_DUPES` <span class="initializer"> =
1</span> ;

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntHash::DO_NOT_USE_ZEND_ALLOC` <span class="initializer"> =
2</span> ;

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntHash::HASHER_NO_HASH` <span class="initializer"> =
256</span> ;

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntHash::HASHER_JENKINS1` <span class="initializer"> =
512</span> ;

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntHash::HASHER_JENKINS2` <span class="initializer"> =
1024</span> ;

/\* Methods \*/

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">add</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> \[, <span
class="methodparam"><span class="type">int</span> `$value`</span> \] )

<span class="modifier">public</span> <span
class="methodname">\_\_construct</span> ( <span
class="methodparam"><span class="type">int</span> `$size`</span> \[,
<span class="methodparam"><span class="type">int</span>
`$options`</span> \] )

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">delete</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> )

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">exists</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> )

<span class="modifier">public</span> <span class="type">int</span> <span
class="methodname">get</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> )

<span class="modifier">public</span> <span class="type">int</span> <span
class="methodname">getSize</span> ( <span
class="methodparam">void</span> )

<span class="modifier">public</span> <span
class="modifier">static</span> <span
class="type">QuickHashIntHash</span> <span
class="methodname">loadFromFile</span> ( <span class="methodparam"><span
class="type">string</span> `$filename`</span> \[, <span
class="methodparam"><span class="type">int</span> `$options`</span> \] )

<span class="modifier">public</span> <span
class="modifier">static</span> <span
class="type">QuickHashIntHash</span> <span
class="methodname">loadFromString</span> ( <span
class="methodparam"><span class="type">string</span> `$contents`</span>
\[, <span class="methodparam"><span class="type">int</span>
`$options`</span> \] )

<span class="modifier">public</span> <span class="type">void</span>
<span class="methodname">saveToFile</span> ( <span
class="methodparam"><span class="type">string</span> `$filename`</span>
)

<span class="modifier">public</span> <span class="type">string</span>
<span class="methodname">saveToString</span> ( <span
class="methodparam">void</span> )

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">set</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> , <span class="methodparam"><span
class="type">int</span> `$value`</span> )

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">update</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> , <span class="methodparam"><span
class="type">int</span> `$value`</span> )

}

预定义常量
----------

**`QuickHashIntHash::CHECK_FOR_DUPES`**  
If enabled, adding duplicate elements to a set (through either add() or
loadFromFile()) will result in those elements to be dropped from the
set. This will take up extra time, so only used when it is required.

**`QuickHashIntHash::DO_NOT_USE_ZEND_ALLOC`**  
Disables the use of PHP's internal memory manager for internal set
structures. With this option enabled, internal allocations will not
count towards the memory\_limit settings.

**`QuickHashIntHash::HASHER_NO_HASH`**  
Selects to not use a hashing function, but merely use a modulo to find
the bucket list index. This is not faster than normal hashing, and gives
more collisions.

**`QuickHashIntHash::HASHER_JENKINS1`**  
This is the default hashing function to turn the integer hashes into
bucket list indexes.

**`QuickHashIntHash::HASHER_JENKINS2`**  
Selects a variant hashing algorithm.

QuickHashIntHash::add
=====================

This method adds a new entry to the hash

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashIntHash::add</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> \[,
<span class="methodparam"><span class="type">int</span> `$value`</span>
\] )

This method adds a new entry to the hash, and returns whether the entry
was added. Entries are by default always added unless
QuickHashIntHash::CHECK\_FOR\_DUPES has been passed when the hash was
created.

### 参数

`key`  
The key of the entry to add.

`value`  
The optional value of the entry to add. If no value is specified, *1*
will be used.

### 返回值

**`TRUE`** when the entry was added, and **`FALSE`** if the entry was
not added.

### 范例

**示例 \#1 <span class="function">QuickHashIntHash::add</span> example**

``` php
<?php
echo "without dupe checking\n";
$hash = new QuickHashIntHash( 1024 );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->get( 4 ) );
var_dump( $hash->add( 4, 22 ) );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->get( 4 ) );
var_dump( $hash->add( 4, 12 ) );

echo "\nwith dupe checking\n";
$hash = new QuickHashIntHash( 1024, QuickHashIntHash::CHECK_FOR_DUPES );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->get( 4 ) );
var_dump( $hash->add( 4, 78 ) );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->get( 4 ) );
var_dump( $hash->add( 4, 9 ) );

echo "\ndefault value\n";
var_dump( $hash->add( 5 ) );
var_dump( $hash->get( 5 ) );
?>
```

以上例程的输出类似于：

    without dupe checking
    bool(false)
    bool(false)
    bool(true)
    bool(true)
    int(22)
    bool(true)

    with dupe checking
    bool(false)
    bool(false)
    bool(true)
    bool(true)
    int(78)
    bool(false)

    default value
    bool(true)
    int(1)

QuickHashIntHash::\_\_construct
===============================

Creates a new QuickHashIntHash object

### 说明

<span class="modifier">public</span> <span
class="methodname">QuickHashIntHash::\_\_construct</span> ( <span
class="methodparam"><span class="type">int</span> `$size`</span> \[,
<span class="methodparam"><span class="type">int</span>
`$options`</span> \] )

This constructor creates a new QuickHashIntHash. The size is the amount
of bucket lists to create. The more lists there are, the less collisions
you will have. Options are also supported.

### 参数

`size`  
The amount of bucket lists to configure. The number you pass in will be
automatically rounded up to the next power of two. It is also
automatically limited from 64 to 4194304.

`options`  
The options that you can pass in are:
QuickHashIntHash::CHECK\_FOR\_DUPES, which makes sure no duplicate
entries are added to the hash;
QuickHashIntHash::DO\_NOT\_USE\_ZEND\_ALLOC to not use PHP's internal
memory manager as well as one of QuickHashIntHash::HASHER\_NO\_HASH,
QuickHashIntHash::HASHER\_JENKINS1 or
QuickHashIntHash::HASHER\_JENKINS2. These last three configure which
hashing algorithm to use. All options can be combined using bitmasks.

### 返回值

Returns a new QuickHashIntHash object.

### 范例

**示例 \#1 <span class="function">QuickHashIntHash::\_\_construct</span>
example**

``` php
<?php
var_dump( new QuickHashIntHash( 1024 ) );
var_dump( new QuickHashIntHash( 1024, QuickHashIntHash::CHECK_FOR_DUPES ) );
var_dump(
    new QuickHashIntHash(
        1024,
        QuickHashIntHash::DO_NOT_USE_ZEND_ALLOC | QuickHashIntHash::HASHER_JENKINS2 
    )
);
?>
```

QuickHashIntHash::delete
========================

This method deletes am entry from the hash

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashIntHash::delete</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> )

This method deletes an entry from the hash, and returns whether the
entry was deleted or not. Associated memory structures will not be freed
immediately, but rather when the hash itself is freed.

Elements can not be deleted when the hash is used in an iterator. The
method will not throw an exception, but simply return **`FALSE`** like
would happen with any other deletion failure.

### 参数

`key`  
The key of the entry to delete.

### 返回值

**`TRUE`** when the entry was deleted, and **`FALSE`** if the entry was
not deleted.

### 范例

**示例 \#1 <span class="function">QuickHashIntHash::delete</span>
example**

``` php
<?php
$hash = new QuickHashIntHash( 1024 );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->add( 4, 5 ) );
var_dump( $hash->delete( 4 ) );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->delete( 4 ) );
?>
```

以上例程的输出类似于：

    bool(false)
    bool(true)
    bool(true)
    bool(false)
    bool(false)

QuickHashIntHash::exists
========================

This method checks whether a key is part of the hash

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashIntHash::exists</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> )

This method checks whether an entry with the provided key exists in the
hash.

### 参数

`key`  
The key of the entry to check for whether it exists in the hash.

### 返回值

Returns **`TRUE`** when the entry was found, or **`FALSE`** when the
entry is not found.

### 范例

**示例 \#1 <span class="function">QuickHashIntHash::exists</span>
example**

``` php
<?php
//generate 200000 elements
$array = range( 0, 199999 );
$existingEntries = array_rand( array_flip( $array ), 180000 );
$testForEntries = array_rand( array_flip( $array ), 1000 );
$foundCount = 0;

echo "Creating hash: ", microtime( true ), "\n";
$hash = new QuickHashIntHash( 100000 );
echo "Adding elements: ", microtime( true ), "\n";
foreach( $existingEntries as $key )
{
     $hash->add( $key, 56 );
}

echo "Doing 1000 tests: ", microtime( true ), "\n";
foreach( $testForEntries as $key )
{
     $foundCount += $hash->exists( $key );
}
echo "Done, $foundCount found: ", microtime( true ), "\n";
?>
```

以上例程的输出类似于：

    Creating hash: 1263588703.0748
    Adding elements: 1263588703.0757
    Doing 1000 tests: 1263588703.7851
    Done, 898 found: 1263588703.7897

QuickHashIntHash::get
=====================

This method retrieves a value from the hash by its key

### 说明

<span class="modifier">public</span> <span class="type">int</span> <span
class="methodname">QuickHashIntHash::get</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> )

This method retrieves a value from the hash by its key.

### 参数

`key`  
The key of the entry to add.

### 返回值

The value if the key exists, or **`NULL`** if the key wasn't part of the
hash.

### 范例

**示例 \#1 <span class="function">QuickHashIntHash::get</span> example**

``` php
<?php
$hash = new QuickHashIntHash( 8 );
var_dump( $hash->get( 1 ) );

var_dump( $hash->add( 2 ) );
var_dump( $hash->get( 2 ) );

var_dump( $hash->add( 3, 5 ) );
var_dump( $hash->get( 3 ) );
?>
```

以上例程的输出类似于：

    bool(false)
    bool(true)
    int(1)
    bool(true)
    int(5)

QuickHashIntHash::getSize
=========================

Returns the number of elements in the hash

### 说明

<span class="modifier">public</span> <span class="type">int</span> <span
class="methodname">QuickHashIntHash::getSize</span> ( <span
class="methodparam">void</span> )

Returns the number of elements in the hash.

### 参数

`key`  
The key of the entry to add.

### 返回值

The number of elements in the hash.

### 范例

**示例 \#1 <span class="function">QuickHashIntHash::getSize</span>
example**

``` php
<?php
$hash = new QuickHashIntHash( 8 );
var_dump( $hash->add( 2 ) );
var_dump( $hash->add( 3, 5 ) );
var_dump( $hash->getSize() );
?>
```

以上例程的输出类似于：

    bool(true)
    bool(true)
    int(2)

QuickHashIntHash::loadFromFile
==============================

This factory method creates a hash from a file

### 说明

<span class="modifier">public</span> <span
class="modifier">static</span> <span
class="type">QuickHashIntHash</span> <span
class="methodname">QuickHashIntHash::loadFromFile</span> ( <span
class="methodparam"><span class="type">string</span> `$filename`</span>
\[, <span class="methodparam"><span class="type">int</span>
`$options`</span> \] )

This factory method creates a new hash from a definition file on disk.
The file format consists of a signature 'QH\\0x11\\0', the number of
elements as a 32 bit signed integer in system Endianness, followed by 32
bit signed integers packed together in the Endianness that the system
that the code runs on uses. For each hash element there are two 32 bit
signed integers stored. The first of each element is the key, and the
second is the value belonging to the key. An example could be:

**示例 \#1 QuickHash IntHash file format**

``` description
00000000  51 48 11 00 02 00 00 00  01 00 00 00 01 00 00 00  |QH..............|
00000010  03 00 00 00 09 00 00 00                           |........|
00000018
```

**示例 \#2 QuickHash IntHash file format**

``` description
header signature ('QH'; key type: 1; value type: 1; filler: \0x00)
00000000  51 48 11 00

number of elements:
00000004  02 00 00 00

data string:
00000000  01 00 00 00 01 00 00 00  03 00 00 00 09 00 00 00

key/value 1 (key = 1, value = 1)
01 00 00 00  01 00 00 00

key/value 2 (key = 3, value = 9)
03 00 00 00  09 00 00 00
```

### 参数

`filename`  
The filename of the file to read the hash from.

`options`  
The same options that the class' constructor takes; except that the size
option is ignored. It is automatically calculated to be the same as the
number of entries in the hash, rounded up to the nearest power of two
with a maximum limit of 4194304.

### 返回值

Returns a new QuickHashIntHash.

### 范例

**示例 \#3 <span class="function">QuickHashIntHash::loadFromFile</span>
example**

``` php
<?php
$file = dirname( __FILE__ ) . "/simple.hash";
$hash = QuickHashIntHash::loadFromFile(
    $file,
    QuickHashIntHash::DO_NOT_USE_ZEND_ALLOC
);
foreach( range( 0, 0x0f ) as $key )
{
    printf( "Key %3d (%2x) is %s\n",
        $key, $key, 
        $hash->exists( $key ) ? 'set' : 'unset'
    );
}
?>
```

以上例程的输出类似于：

    Key   0 ( 0) is unset
    Key   1 ( 1) is set
    Key   2 ( 2) is set
    Key   3 ( 3) is set
    Key   4 ( 4) is unset
    Key   5 ( 5) is set
    Key   6 ( 6) is unset
    Key   7 ( 7) is set
    Key   8 ( 8) is unset
    Key   9 ( 9) is unset
    Key  10 ( a) is unset
    Key  11 ( b) is set
    Key  12 ( c) is unset
    Key  13 ( d) is set
    Key  14 ( e) is unset
    Key  15 ( f) is unset

QuickHashIntHash::loadFromString
================================

This factory method creates a hash from a string

### 说明

<span class="modifier">public</span> <span
class="modifier">static</span> <span
class="type">QuickHashIntHash</span> <span
class="methodname">QuickHashIntHash::loadFromString</span> ( <span
class="methodparam"><span class="type">string</span> `$contents`</span>
\[, <span class="methodparam"><span class="type">int</span>
`$options`</span> \] )

This factory method creates a new hash from a definition in a string.
The file format consists of 32 bit signed integers packed together in
the Endianness that the system that the code runs on uses. For each
element there are two 32 bit signed integers stored. The first of each
element is the key, and the second is the value belonging to the key.

### 参数

`contents`  
The string containing a serialized format of the hash.

`options`  
The same options that the class' constructor takes; except that the size
option is ignored. It is automatically calculated to be the same as the
number of entries in the hash, rounded up to the nearest power of two
with a maximum limit of 4194304.

### 返回值

Returns a new QuickHashIntHash.

### 范例

**示例 \#1 <span
class="function">QuickHashIntHash::loadFromString</span> example**

``` php
<?php
$contents = file_get_contents( dirname( __FILE__ ) . "/simple.hash" );
$hash = QuickHashIntHash::loadFromString(
    $contents,
    QuickHashIntHash::DO_NOT_USE_ZEND_ALLOC
);
foreach( range( 0, 0x0f ) as $key )
{
    printf( "Key %3d (%2x) is %s\n",
        $key, $key, 
        $hash->exists( $key ) ? 'set' : 'unset'
    );
}
?>
```

以上例程的输出类似于：

    Key   0 ( 0) is unset
    Key   1 ( 1) is set
    Key   2 ( 2) is set
    Key   3 ( 3) is set
    Key   4 ( 4) is unset
    Key   5 ( 5) is set
    Key   6 ( 6) is unset
    Key   7 ( 7) is set
    Key   8 ( 8) is unset
    Key   9 ( 9) is unset
    Key  10 ( a) is unset
    Key  11 ( b) is set
    Key  12 ( c) is unset
    Key  13 ( d) is set
    Key  14 ( e) is unset
    Key  15 ( f) is unset

QuickHashIntHash::saveToFile
============================

This method stores an in-memory hash to disk

### 说明

<span class="modifier">public</span> <span class="type">void</span>
<span class="methodname">QuickHashIntHash::saveToFile</span> ( <span
class="methodparam"><span class="type">string</span> `$filename`</span>
)

This method stores an existing hash to a file on disk, in the same
format that loadFromFile() can read.

### 参数

`filename`  
The filename of the file to store the hash in.

### 返回值

没有返回值。

### 范例

**示例 \#1 <span class="function">QuickHashIntHash::saveToFile</span>
example**

``` php
<?php
$hash = new QuickHashIntHash( 1024 );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->add( 4, 43 ) );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->add( 4, 52 ) );

$hash->saveToFile( '/tmp/test.hash' );
?>
```

QuickHashIntHash::saveToString
==============================

This method returns a serialized version of the hash

### 说明

<span class="modifier">public</span> <span class="type">string</span>
<span class="methodname">QuickHashIntHash::saveToString</span> ( <span
class="methodparam">void</span> )

This method returns a serialized version of the hash in the same format
that loadFromString() can read.

### 返回值

This method returns a string containing a serialized format of the hash.
Each element is stored as a four byte value in the Endianness that the
current system uses.

### 范例

**示例 \#1 <span class="function">QuickHashIntHash::saveToString</span>
example**

``` php
<?php
$hash = new QuickHashIntHash( 1024 );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->add( 4, 34 ) );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->add( 4, 55 ) );

var_dump( $hash->saveToString() );
?>
```

QuickHashIntHash::set
=====================

This method updates an entry in the hash with a new value, or adds a new
one if the entry doesn't exist

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashIntHash::set</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> , <span
class="methodparam"><span class="type">int</span> `$value`</span> )

This method tries to update an entry with a new value. In case the entry
did not yet exist, it will instead add a new entry. It returns whether
the entry was added or update. If there are duplicate keys, only the
first found element will get an updated value. Use
QuickHashIntHash::CHECK\_FOR\_DUPES during hash creation to prevent
duplicate keys from being part of the hash.

### 参数

`key`  
The key of the entry to add or update.

`value`  
The new value to set the entry with.

### 返回值

2 if the entry was found and updated, 1 if the entry was newly added or
0 if there was an error.

### 范例

**示例 \#1 <span class="function">QuickHashIntHash::set</span> example**

``` php
<?php
$hash = new QuickHashIntHash( 1024 );

echo "Set->Add\n";
var_dump( $hash->get( 46692 ) );
var_dump( $hash->set( 46692, 16091 ) );
var_dump( $hash->get( 46692 ) );

echo "Set->Update\n";
var_dump( $hash->set( 46692, 29906 ) );
var_dump( $hash->get( 46692 ) );
?>
```

以上例程的输出类似于：

    bool(false)
    int(2)
    int(16091)
    Set->Update
    int(1)
    int(29906)

QuickHashIntHash::update
========================

This method updates an entry in the hash with a new value

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashIntHash::update</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> , <span
class="methodparam"><span class="type">int</span> `$value`</span> )

This method updates an entry with a new value, and returns whether the
entry was update. If there are duplicate keys, only the first found
element will get an updated value. Use
QuickHashIntHash::CHECK\_FOR\_DUPES during hash creation to prevent
duplicate keys from being part of the hash.

### 参数

`key`  
The key of the entry to add.

`value`  
The new value to update the entry with.

### 返回值

**`TRUE`** when the entry was found and updated, and **`FALSE`** if the
entry was not part of the hash already.

### 范例

**示例 \#1 <span class="function">QuickHashIntHash::update</span>
example**

``` php
<?php
$hash = new QuickHashIntHash( 1024 );

var_dump( $hash->add( 141421, 173205 ) );
var_dump( $hash->update( 141421, 223606 ) );
var_dump( $hash->get( 141421 ) );
?>
```

以上例程的输出类似于：

    bool(true)
    bool(true)
    int(223606)

简介
----

This class wraps around a hash containing strings, where the values are
integer numbers. Hashes are also available as implementation of the
ArrayAccess interface.

Hashes can also be iterated over with foreach as the Iterator interface
is implemented as well. The order of which elements are returned in is
not guaranteed.

类摘要
------

**QuickHashStringIntHash**

<span class="ooclass"> class **QuickHashStringIntHash** </span> {

/\* Constants \*/

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashStringIntHash::CHECK_FOR_DUPES` <span class="initializer"> =
1</span> ;

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashStringIntHash::DO_NOT_USE_ZEND_ALLOC` <span
class="initializer"> = 2</span> ;

/\* Methods \*/

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">add</span> ( <span class="methodparam"><span
class="type">string</span> `$key`</span> , <span
class="methodparam"><span class="type">int</span> `$value`</span> )

<span class="modifier">public</span> <span
class="methodname">\_\_construct</span> ( <span
class="methodparam"><span class="type">int</span> `$size`</span> \[,
<span class="methodparam"><span class="type">int</span> `$options`<span
class="initializer"> = 0</span></span> \] )

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">delete</span> ( <span class="methodparam"><span
class="type">string</span> `$key`</span> )

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">exists</span> ( <span class="methodparam"><span
class="type">string</span> `$key`</span> )

<span class="modifier">public</span> <span class="type">mixed</span>
<span class="methodname">get</span> ( <span class="methodparam"><span
class="type">string</span> `$key`</span> )

<span class="modifier">public</span> <span class="type">int</span> <span
class="methodname">getSize</span> ( <span
class="methodparam">void</span> )

<span class="modifier">public</span> <span
class="modifier">static</span> <span
class="type">QuickHashStringIntHash</span> <span
class="methodname">loadFromFile</span> ( <span class="methodparam"><span
class="type">string</span> `$filename`</span> \[, <span
class="methodparam"><span class="type">int</span> `$size`<span
class="initializer"> = 0</span></span> \[, <span
class="methodparam"><span class="type">int</span> `$options`<span
class="initializer"> = 0</span></span> \]\] )

<span class="modifier">public</span> <span
class="modifier">static</span> <span
class="type">QuickHashStringIntHash</span> <span
class="methodname">loadFromString</span> ( <span
class="methodparam"><span class="type">string</span> `$contents`</span>
\[, <span class="methodparam"><span class="type">int</span> `$size`<span
class="initializer"> = 0</span></span> \[, <span
class="methodparam"><span class="type">int</span> `$options`<span
class="initializer"> = 0</span></span> \]\] )

<span class="modifier">public</span> <span class="type">void</span>
<span class="methodname">saveToFile</span> ( <span
class="methodparam"><span class="type">string</span> `$filename`</span>
)

<span class="modifier">public</span> <span class="type">string</span>
<span class="methodname">saveToString</span> ( <span
class="methodparam">void</span> )

<span class="modifier">public</span> <span class="type">int</span> <span
class="methodname">set</span> ( <span class="methodparam"><span
class="type">string</span> `$key`</span> , <span
class="methodparam"><span class="type">int</span> `$value`</span> )

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">update</span> ( <span class="methodparam"><span
class="type">string</span> `$key`</span> , <span
class="methodparam"><span class="type">int</span> `$value`</span> )

}

预定义常量
----------

**`QuickHashStringIntHash::CHECK_FOR_DUPES`**  
If enabled, adding duplicate elements to a set (through either add() or
loadFromFile()) will result in those elements to be dropped from the
set. This will take up extra time, so only used when it is required.

**`QuickHashStringIntHash::DO_NOT_USE_ZEND_ALLOC`**  
Disables the use of PHP's internal memory manager for internal set
structures. With this option enabled, internal allocations will not
count towards the memory\_limit settings.

QuickHashStringIntHash::add
===========================

This method adds a new entry to the hash

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashStringIntHash::add</span> ( <span
class="methodparam"><span class="type">string</span> `$key`</span> ,
<span class="methodparam"><span class="type">int</span> `$value`</span>
)

This method adds a new entry to the hash, and returns whether the entry
was added. Entries are by default always added unless
QuickHashStringIntHash::CHECK\_FOR\_DUPES has been passed when the hash
was created.

### 参数

`key`  
The key of the entry to add.

`value`  
The value of the entry to add.

### 返回值

**`TRUE`** when the entry was added, and **`FALSE`** if the entry was
not added.

### 范例

**示例 \#1 <span class="function">QuickHashStringIntHash::add</span>
example**

``` php
<?php
echo "without dupe checking\n";
$hash = new QuickHashStringIntHash( 1024 );
var_dump( $hash );
var_dump( $hash->exists( "four" ) );
var_dump( $hash->get( "four" ) );
var_dump( $hash->add( "four", 22 ) );
var_dump( $hash->exists( "four" ) );
var_dump( $hash->get( "four" ) );
var_dump( $hash->add( "four", 12 ) );

echo "\nwith dupe checking\n";
$hash = new QuickHashStringIntHash( 1024, QuickHashStringIntHash::CHECK_FOR_DUPES );
var_dump( $hash );
var_dump( $hash->exists( "four" ) );
var_dump( $hash->get( "four" ) );
var_dump( $hash->add( "four", 78 ) );
var_dump( $hash->exists( "four" ) );
var_dump( $hash->get( "four" ) );
var_dump( $hash->add( "four", 9 ) );
?>
```

以上例程的输出类似于：

    without dupe checking
    object(QuickHashStringIntHash)#1 (0) {
    }
    bool(false)
    bool(false)
    bool(true)
    bool(true)
    int(22)
    bool(true)

    with dupe checking
    object(QuickHashStringIntHash)#2 (0) {
    }
    bool(false)
    bool(false)
    bool(true)
    bool(true)
    int(78)
    bool(false)

QuickHashStringIntHash::\_\_construct
=====================================

Creates a new QuickHashStringIntHash object

### 说明

<span class="modifier">public</span> <span
class="methodname">QuickHashStringIntHash::\_\_construct</span> ( <span
class="methodparam"><span class="type">int</span> `$size`</span> \[,
<span class="methodparam"><span class="type">int</span> `$options`<span
class="initializer"> = 0</span></span> \] )

This constructor creates a new QuickHashStringIntHash. The size is the
amount of bucket lists to create. The more lists there are, the less
collisions you will have. Options are also supported.

### 参数

`size`  
The amount of bucket lists to configure. The number you pass in will be
automatically rounded up to the next power of two. It is also
automatically limited from 64 to 4194304.

`options`  
The options that you can pass in are:
QuickHashStringIntHash::CHECK\_FOR\_DUPES, which makes sure no duplicate
entries are added to the hash and
QuickHashStringIntHash::DO\_NOT\_USE\_ZEND\_ALLOC to not use PHP's
internal memory manager.

### 返回值

Returns a new QuickHashStringIntHash object.

### 范例

**示例 \#1 <span
class="function">QuickHashStringIntHash::\_\_construct</span> example**

``` php
<?php
var_dump( new QuickHashStringIntHash( 1024 ) );
var_dump( new QuickHashStringIntHash( 1024, QuickHashStringIntHash::CHECK_FOR_DUPES ) );
?>
```

QuickHashStringIntHash::delete
==============================

This method deletes am entry from the hash

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashStringIntHash::delete</span> ( <span
class="methodparam"><span class="type">string</span> `$key`</span> )

This method deletes an entry from the hash, and returns whether the
entry was deleted or not. Associated memory structures will not be freed
immediately, but rather when the hash itself is freed.

Elements can not be deleted when the hash is used in an iterator. The
method will not throw an exception, but simply return **`FALSE`** like
would happen with any other deletion failure.

### 参数

`key`  
The key of the entry to delete.

### 返回值

**`TRUE`** when the entry was deleted, and **`FALSE`** if the entry was
not deleted.

### 范例

**示例 \#1 <span class="function">QuickHashStringIntHash::delete</span>
example**

``` php
<?php
$hash = new QuickHashStringIntHash( 1024 );
var_dump( $hash->exists( 'four' ) );
var_dump( $hash->add( 'four', 5 ) );
var_dump( $hash->get( 'four' ) );
var_dump( $hash->delete( 'four' ) );
var_dump( $hash->exists( 'four' ) );
var_dump( $hash->get( 'four' ) );
var_dump( $hash->delete( 'four' ) );
?>
```

以上例程的输出类似于：

    bool(false)
    bool(true)
    int(5)
    bool(true)
    bool(false)
    bool(false)
    bool(false)

QuickHashStringIntHash::exists
==============================

This method checks whether a key is part of the hash

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashStringIntHash::exists</span> ( <span
class="methodparam"><span class="type">string</span> `$key`</span> )

This method checks whether an entry with the provided key exists in the
hash.

### 参数

`key`  
The key of the entry to check for whether it exists in the hash.

### 返回值

Returns **`TRUE`** when the entry was found, or **`FALSE`** when the
entry is not found.

QuickHashStringIntHash::get
===========================

This method retrieves a value from the hash by its key

### 说明

<span class="modifier">public</span> <span class="type">mixed</span>
<span class="methodname">QuickHashStringIntHash::get</span> ( <span
class="methodparam"><span class="type">string</span> `$key`</span> )

This method retrieves a value from the hash by its key.

### 参数

`key`  
The key of the entry to add.

### 返回值

The value if the key exists, or **`NULL`** if the key wasn't part of the
hash.

### 范例

**示例 \#1 <span class="function">QuickHashStringIntHash::get</span>
example**

``` php
<?php
$hash = new QuickHashStringIntHash( 8 );
var_dump( $hash->get( "one" ) );

var_dump( $hash->add( "two", 2 ) );
var_dump( $hash->get( "two" ) );
?>
```

以上例程的输出类似于：

    bool(false)
    bool(true)
    int(2)

QuickHashStringIntHash::getSize
===============================

Returns the number of elements in the hash

### 说明

<span class="modifier">public</span> <span class="type">int</span> <span
class="methodname">QuickHashStringIntHash::getSize</span> ( <span
class="methodparam">void</span> )

Returns the number of elements in the hash.

### 参数

`key`  
The key of the entry to add.

### 返回值

The number of elements in the hash.

### 范例

**示例 \#1 <span class="function">QuickHashStringIntHash::getSize</span>
example**

``` php
<?php
$hash = new QuickHashStringIntHash( 8 );
var_dump( $hash->add( "two", 2 ) );
var_dump( $hash->add( "three", 5 ) );
var_dump( $hash->getSize() );
?>
```

以上例程的输出类似于：

    bool(true)
    bool(true)
    int(2)

QuickHashStringIntHash::loadFromFile
====================================

This factory method creates a hash from a file

### 说明

<span class="modifier">public</span> <span
class="modifier">static</span> <span
class="type">QuickHashStringIntHash</span> <span
class="methodname">QuickHashStringIntHash::loadFromFile</span> ( <span
class="methodparam"><span class="type">string</span> `$filename`</span>
\[, <span class="methodparam"><span class="type">int</span> `$size`<span
class="initializer"> = 0</span></span> \[, <span
class="methodparam"><span class="type">int</span> `$options`<span
class="initializer"> = 0</span></span> \]\] )

This factory method creates a new hash from a definition file on disk.
The file format consists of a signature 'QH\\0x21\\0', the number of
elements as a 32 bit signed integer in system Endianness, an unsigned 32
bit integer containing the number of element data to follow in
characters. This element data contains all the strings. The follows
another signed 32 bit integer containing the number of bucket lists.
After the header and the strings, the elements follow. They are ordered
by bucket list so that the keys don't have to be hashed in order to
restore the hash. For each bucket list, the following information is
stored (all as 32 bit integers): the bucket list index, the number of
elements in that list, and then in pairs of two unsigned 32 bit integers
the elements, where the first one is the index into the string list
containing the keys, and the second one the value. An example could be:

**示例 \#1 QuickHash StringIntHash file format**

``` description
00000000  51 48 21 00 02 00 00 00  09 00 00 00 40 00 00 00  |QH!.........@...|
00000010  4f 4e 45 00 4e 49 4e 45  00 07 00 00 00 01 00 00  |ONE.NINE........|
00000020  00 00 00 00 00 01 00 00  00 2f 00 00 00 01 00 00  |........./......|
00000030  00 04 00 00 00 03 00 00  00                       |.........|
00000039
```

**示例 \#2 QuickHash IntHash file format**

``` description
header signature ('QH'; key type: 2; value type: 1; filler: \0x00)
00000000  51 48 21 00

number of elements:
00000004  02 00 00 00

length of string values (9 characters):
00000008  09 00 00 00

number of hash bucket lists (this is configured for hashes as argument to the
constructor normally, 64 in this case):
0000000C  40 00 00 00

string values:
00000010  4f 4e 45 00 4e 49 4e 45  00

bucket lists:
  bucket list 1 (with key 7, and 1 element):
    header:
    07 00 00 00 01 00 00 00
    elements (key index: 0 ('ONE'), value = 0):
    00 00 00 00 01 00 00 00
  bucket list 2 (with key 0x2f, and 1 element):
    header:
    2f 00 00 00 01 00 00 00
    elements (key index: 4 ('NINE'), value = 3):
    04 00 00 00 03 00 00 00
```

### 参数

`filename`  
The filename of the file to read the hash from.

`size`  
The amount of bucket lists to configure. The number you pass in will be
automatically rounded up to the next power of two. It is also
automatically limited from 4 to 4194304.

`options`  
The same options that the class' constructor takes; except that the size
option is ignored. It is read from the file format (unlike the
QuickHashIntHash and QuickHashIntStringHash classes, where it is
automatically calculated from the number of entries in the hash.)

### 返回值

Returns a new QuickHashStringIntHash.

### 范例

**示例 \#3 <span
class="function">QuickHashStringIntHash::loadFromFile</span> example**

``` php
<?php
$file = dirname( __FILE__ ) . "/simple.hash.string";
$hash = QuickHashStringIntHash::loadFromFile(
    $file,
    QuickHashStringIntHash::DO_NOT_USE_ZEND_ALLOC
);
foreach( range( 0, 0x0f ) as $key )
{
    $i = 48712 + $key * 1631;
    $k = base_convert( $i, 10, 36 );
    echo $k, ' => ', $hash->get( $k ), "\n";
}
?>
```

以上例程的输出类似于：

    11l4 => 48712
    12uf => 50343
    143q => 51974
    15d1 => 53605
    16mc => 55236
    17vn => 56867
    194y => 58498
    1ae9 => 60129
    1bnk => 61760
    1cwv => 63391
    1e66 => 65022
    1ffh => 66653
    1gos => 68284
    1hy3 => 69915
    1j7e => 71546
    1kgp => 73177

QuickHashStringIntHash::loadFromString
======================================

This factory method creates a hash from a string

### 说明

<span class="modifier">public</span> <span
class="modifier">static</span> <span
class="type">QuickHashStringIntHash</span> <span
class="methodname">QuickHashStringIntHash::loadFromString</span> ( <span
class="methodparam"><span class="type">string</span> `$contents`</span>
\[, <span class="methodparam"><span class="type">int</span> `$size`<span
class="initializer"> = 0</span></span> \[, <span
class="methodparam"><span class="type">int</span> `$options`<span
class="initializer"> = 0</span></span> \]\] )

This factory method creates a new hash from a definition in a string.
The format is the same as the one used in "loadFromFile".

### 参数

`contents`  
The string containing a serialized format of the hash.

`size`  
The amount of bucket lists to configure. The number you pass in will be
automatically rounded up to the next power of two. It is also
automatically limited from 4 to 4194304.

`options`  
The same options that the class' constructor takes; except that the size
option is ignored. It is automatically calculated to be the same as the
number of entries in the hash, rounded up to the nearest power of two
with a maximum limit of 4194304.

### 返回值

Returns a new QuickHashStringIntHash.

### 范例

**示例 \#1 <span
class="function">QuickHashStringIntHash::loadFromString</span> example**

``` php
<?php
$contents = file_get_contents( dirname( __FILE__ ) . "/simple.hash.string" );
$hash = QuickHashStringIntHash::loadFromString(
    $contents,
    QuickHashStringIntHash::DO_NOT_USE_ZEND_ALLOC
);
foreach( range( 0, 0x0f ) as $key )
{
    $i = 48712 + $key * 1631;
    $k = base_convert( $i, 10, 36 );
    echo $k, ' => ', $hash->get( $k ), "\n";
}
?>
```

以上例程的输出类似于：

    11l4 => 48712
    12uf => 50343
    143q => 51974
    15d1 => 53605
    16mc => 55236
    17vn => 56867
    194y => 58498
    1ae9 => 60129
    1bnk => 61760
    1cwv => 63391
    1e66 => 65022
    1ffh => 66653
    1gos => 68284
    1hy3 => 69915
    1j7e => 71546
    1kgp => 73177

QuickHashStringIntHash::saveToFile
==================================

This method stores an in-memory hash to disk

### 说明

<span class="modifier">public</span> <span class="type">void</span>
<span class="methodname">QuickHashStringIntHash::saveToFile</span> (
<span class="methodparam"><span class="type">string</span>
`$filename`</span> )

This method stores an existing hash to a file on disk, in the same
format that loadFromFile() can read.

### 参数

`filename`  
The filename of the file to store the hash in.

### 返回值

没有返回值。

### 范例

**示例 \#1 <span
class="function">QuickHashStringIntHash::saveToFile</span> example**

``` php
<?php
$hash = new QuickHashStringIntHash( 1024 );
var_dump( $hash->add( "fourty three", 42 ) );
var_dump( $hash->add( "fifty two", 52 ) );

$hash->saveToFile( '/tmp/test.hash.string' );
?>
```

QuickHashStringIntHash::saveToString
====================================

This method returns a serialized version of the hash

### 说明

<span class="modifier">public</span> <span class="type">string</span>
<span class="methodname">QuickHashStringIntHash::saveToString</span> (
<span class="methodparam">void</span> )

This method returns a serialized version of the hash in the same format
that loadFromString() can read.

### 返回值

This method returns a serialized format of an existing hash, in the same
format that loadFromString() can read.

### 范例

**示例 \#1 <span
class="function">QuickHashStringIntHash::saveToString</span> example**

``` php
<?php
$hash = new QuickHashStringIntHash( 1024 );
var_dump( $hash->add( "fourty three", 42 ) );
var_dump( $hash->add( "fifty two", 52 ) );

var_dump( $hash->saveToString() );
?>
```

QuickHashStringIntHash::set
===========================

This method updates an entry in the hash with a new value, or adds a new
one if the entry doesn't exist

### 说明

<span class="modifier">public</span> <span class="type">int</span> <span
class="methodname">QuickHashStringIntHash::set</span> ( <span
class="methodparam"><span class="type">string</span> `$key`</span> ,
<span class="methodparam"><span class="type">int</span> `$value`</span>
)

This method tries to update an entry with a new value. In case the entry
did not yet exist, it will instead add a new entry. It returns whether
the entry was added or update. If there are duplicate keys, only the
first found element will get an updated value. Use
QuickHashStringIntHash::CHECK\_FOR\_DUPES during hash creation to
prevent duplicate keys from being part of the hash.

### 参数

`key`  
The key of the entry to add or update.

`value`  
The value of the entry to add. If a non-string is passed, it will be
converted to a string automatically if possible.

### 返回值

2 if the entry was found and updated, 1 if the entry was newly added or
0 if there was an error.

### 范例

**示例 \#1 <span class="function">QuickHashStringIntHash::set</span>
example**

``` php
<?php
$hash = new QuickHashStringIntHash( 1024 );

echo "Set->Add\n";
var_dump( $hash->get( "fourty six thousand six hundred ninety two" ) );
var_dump( $hash->set( "fourty six thousand six hundred ninety two", 16091 ) );
var_dump( $hash->get( "fourty six thousand six hundred ninety two" ) );

echo "Set->Update\n";
var_dump( $hash->set( "fourty six thousand six hundred ninety two", 29906 ) );
var_dump( $hash->get( "fourty six thousand six hundred ninety two" ) );
?>
```

以上例程的输出类似于：

    Set->Add
    bool(false)
    int(2)
    int(16091)
    Set->Update
    int(1)
    int(29906)

QuickHashStringIntHash::update
==============================

This method updates an entry in the hash with a new value

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashStringIntHash::update</span> ( <span
class="methodparam"><span class="type">string</span> `$key`</span> ,
<span class="methodparam"><span class="type">int</span> `$value`</span>
)

This method updates an entry with a new value, and returns whether the
entry was update. If there are duplicate keys, only the first found
element will get an updated value. Use
QuickHashStringIntHash::CHECK\_FOR\_DUPES during hash creation to
prevent duplicate keys from being part of the hash.

### 参数

`key`  
The key of the entry to add.

`value`  
The new value for the entry. If a non-string is passed, it will be
converted to a string automatically if possible.

### 返回值

**`TRUE`** when the entry was found and updated, and **`FALSE`** if the
entry was not part of the hash already.

### 范例

**示例 \#1 <span class="function">QuickHashStringIntHash::update</span>
example**

``` php
<?php
$hash = new QuickHashStringIntHash( 1024 );

$hash->add( 'six', 314159265 );
$hash->add( "a lot", 314159265 );

echo $hash->get( 'six' ), "\n";
echo $hash->get( 'a lot' ), "\n";

var_dump( $hash->update( 'a lot', 314159266 ) ); 
var_dump( $hash->update( "a lot plus one", 314159999 ) );

echo $hash->get( 'six' ), "\n";
echo $hash->get( 'a lot' ), "\n";
?>
```

以上例程的输出类似于：

    314159265
    314159265
    bool(true)
    bool(false)
    314159265
    314159266

简介
----

This class wraps around a hash containing integer numbers, where the
values are strings. Hashes are also available as implementation of the
ArrayAccess interface.

Hashes can also be iterated over with foreach as the Iterator interface
is implemented as well. The order of which elements are returned in is
not guaranteed.

类摘要
------

**QuickHashIntStringHash**

<span class="ooclass"> class **QuickHashIntStringHash** </span> {

/\* Constants \*/

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntStringHash::CHECK_FOR_DUPES` <span class="initializer"> =
1</span> ;

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntStringHash::DO_NOT_USE_ZEND_ALLOC` <span
class="initializer"> = 2</span> ;

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntStringHash::HASHER_NO_HASH` <span class="initializer"> =
256</span> ;

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntStringHash::HASHER_JENKINS1` <span class="initializer"> =
512</span> ;

<span class="modifier">const</span> <span class="type">int</span>
`QuickHashIntStringHash::HASHER_JENKINS2` <span class="initializer"> =
1024</span> ;

/\* Methods \*/

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">add</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> , <span class="methodparam"><span
class="type">string</span> `$value`</span> )

<span class="modifier">public</span> <span
class="methodname">\_\_construct</span> ( <span
class="methodparam"><span class="type">int</span> `$size`</span> \[,
<span class="methodparam"><span class="type">int</span> `$options`<span
class="initializer"> = 0</span></span> \] )

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">delete</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> )

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">exists</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> )

<span class="modifier">public</span> <span class="type">mixed</span>
<span class="methodname">get</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> )

<span class="modifier">public</span> <span class="type">int</span> <span
class="methodname">getSize</span> ( <span
class="methodparam">void</span> )

<span class="modifier">public</span> <span
class="modifier">static</span> <span
class="type">QuickHashIntStringHash</span> <span
class="methodname">loadFromFile</span> ( <span class="methodparam"><span
class="type">string</span> `$filename`</span> \[, <span
class="methodparam"><span class="type">int</span> `$size`<span
class="initializer"> = 0</span></span> \[, <span
class="methodparam"><span class="type">int</span> `$options`<span
class="initializer"> = 0</span></span> \]\] )

<span class="modifier">public</span> <span
class="modifier">static</span> <span
class="type">QuickHashIntStringHash</span> <span
class="methodname">loadFromString</span> ( <span
class="methodparam"><span class="type">string</span> `$contents`</span>
\[, <span class="methodparam"><span class="type">int</span> `$size`<span
class="initializer"> = 0</span></span> \[, <span
class="methodparam"><span class="type">int</span> `$options`<span
class="initializer"> = 0</span></span> \]\] )

<span class="modifier">public</span> <span class="type">void</span>
<span class="methodname">saveToFile</span> ( <span
class="methodparam"><span class="type">string</span> `$filename`</span>
)

<span class="modifier">public</span> <span class="type">string</span>
<span class="methodname">saveToString</span> ( <span
class="methodparam">void</span> )

<span class="modifier">public</span> <span class="type">int</span> <span
class="methodname">set</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> , <span class="methodparam"><span
class="type">string</span> `$value`</span> )

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">update</span> ( <span class="methodparam"><span
class="type">int</span> `$key`</span> , <span class="methodparam"><span
class="type">string</span> `$value`</span> )

}

预定义常量
----------

**`QuickHashIntStringHash::CHECK_FOR_DUPES`**  
If enabled, adding duplicate elements to a set (through either add() or
loadFromFile()) will result in those elements to be dropped from the
set. This will take up extra time, so only used when it is required.

**`QuickHashIntStringHash::DO_NOT_USE_ZEND_ALLOC`**  
Disables the use of PHP's internal memory manager for internal set
structures. With this option enabled, internal allocations will not
count towards the memory\_limit settings.

**`QuickHashIntStringHash::HASHER_NO_HASH`**  
Selects to not use a hashing function, but merely use a modulo to find
the bucket list index. This is not faster than normal hashing, and gives
more collisions.

**`QuickHashIntStringHash::HASHER_JENKINS1`**  
This is the default hashing function to turn the integer hashes into
bucket list indexes.

**`QuickHashIntStringHash::HASHER_JENKINS2`**  
Selects a variant hashing algorithm.

QuickHashIntStringHash::add
===========================

This method adds a new entry to the hash

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashIntStringHash::add</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> , <span
class="methodparam"><span class="type">string</span> `$value`</span> )

This method adds a new entry to the hash, and returns whether the entry
was added. Entries are by default always added unless
QuickHashIntStringHash::CHECK\_FOR\_DUPES has been passed when the hash
was created.

### 参数

`key`  
The key of the entry to add.

`value`  
The value of the entry to add. If a non-string is passed, it will be
converted to a string automatically if possible.

### 返回值

**`TRUE`** when the entry was added, and **`FALSE`** if the entry was
not added.

### 范例

**示例 \#1 <span class="function">QuickHashIntStringHash::add</span>
example**

``` php
<?php
echo "without dupe checking\n";
$hash = new QuickHashIntStringHash( 1024 );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->get( 4 ) );
var_dump( $hash->add( 4, "twenty two" ) );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->get( 4 ) );
var_dump( $hash->add( 4, "twelve" ) );

echo "\nwith dupe checking\n";
$hash = new QuickHashIntStringHash( 1024, QuickHashIntStringHash::CHECK_FOR_DUPES );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->get( 4 ) );
var_dump( $hash->add( 4, "seventy eight" ) );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->get( 4 ) );
var_dump( $hash->add( 4, "nine" ) );
?>
```

以上例程的输出类似于：

    without dupe checking
    bool(false)
    bool(false)
    bool(true)
    bool(true)
    string(10) "twenty two"
    bool(true)

    with dupe checking
    bool(false)
    bool(false)
    bool(true)
    bool(true)
    string(13) "seventy eight"
    bool(false)

QuickHashIntStringHash::\_\_construct
=====================================

Creates a new QuickHashIntStringHash object

### 说明

<span class="modifier">public</span> <span
class="methodname">QuickHashIntStringHash::\_\_construct</span> ( <span
class="methodparam"><span class="type">int</span> `$size`</span> \[,
<span class="methodparam"><span class="type">int</span> `$options`<span
class="initializer"> = 0</span></span> \] )

This constructor creates a new QuickHashIntStringHash. The size is the
amount of bucket lists to create. The more lists there are, the less
collisions you will have. Options are also supported.

### 参数

`size`  
The amount of bucket lists to configure. The number you pass in will be
automatically rounded up to the next power of two. It is also
automatically limited from 64 to 4194304.

`options`  
The options that you can pass in are:
QuickHashIntStringHash::CHECK\_FOR\_DUPES, which makes sure no duplicate
entries are added to the hash;
QuickHashIntStringHash::DO\_NOT\_USE\_ZEND\_ALLOC to not use PHP's
internal memory manager as well as one of
QuickHashIntStringHash::HASHER\_NO\_HASH,
QuickHashIntStringHash::HASHER\_JENKINS1 or
QuickHashIntStringHash::HASHER\_JENKINS2. These last three configure
which hashing algorithm to use. All options can be combined using
bitmasks.

### 返回值

Returns a new QuickHashIntStringHash object.

### 范例

**示例 \#1 <span
class="function">QuickHashIntStringHash::\_\_construct</span> example**

``` php
<?php
var_dump( new QuickHashIntStringHash( 1024 ) );
var_dump( new QuickHashIntStringHash( 1024, QuickHashIntStringHash::CHECK_FOR_DUPES ) );
var_dump(
    new QuickHashIntStringHash(
        1024,
        QuickHashIntStringHash::DO_NOT_USE_ZEND_ALLOC | QuickHashIntStringHash::HASHER_JENKINS2 
    )
);
?>
```

QuickHashIntStringHash::delete
==============================

This method deletes am entry from the hash

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashIntStringHash::delete</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> )

This method deletes an entry from the hash, and returns whether the
entry was deleted or not. Associated memory structures will not be freed
immediately, but rather when the hash itself is freed.

Elements can not be deleted when the hash is used in an iterator. The
method will not throw an exception, but simply return **`FALSE`** like
would happen with any other deletion failure.

### 参数

`key`  
The key of the entry to delete.

### 返回值

**`TRUE`** when the entry was deleted, and **`FALSE`** if the entry was
not deleted.

### 范例

**示例 \#1 <span class="function">QuickHashIntStringHash::delete</span>
example**

``` php
<?php
$hash = new QuickHashIntStringHash( 1024 );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->add( 4, "five" ) );
var_dump( $hash->delete( 4 ) );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->delete( 4 ) );
?>
```

以上例程的输出类似于：

    bool(false)
    bool(true)
    bool(true)
    bool(false)
    bool(false)

QuickHashIntStringHash::exists
==============================

This method checks whether a key is part of the hash

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashIntStringHash::exists</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> )

This method checks whether an entry with the provided key exists in the
hash.

### 参数

`key`  
The key of the entry to check for whether it exists in the hash.

### 返回值

Returns **`TRUE`** when the entry was found, or **`FALSE`** when the
entry is not found.

QuickHashIntStringHash::get
===========================

This method retrieves a value from the hash by its key

### 说明

<span class="modifier">public</span> <span class="type">mixed</span>
<span class="methodname">QuickHashIntStringHash::get</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> )

This method retrieves a value from the hash by its key.

### 参数

`key`  
The key of the entry to add.

### 返回值

The value if the key exists, or **`NULL`** if the key wasn't part of the
hash.

### 范例

**示例 \#1 <span class="function">QuickHashIntStringHash::get</span>
example**

``` php
<?php
$hash = new QuickHashIntStringHash( 8 );
var_dump( $hash->get( 1 ) );

var_dump( $hash->add( 2, "two" ) );
var_dump( $hash->get( 2 ) );

var_dump( $hash->add( 3, 5 ) );
var_dump( $hash->get( 3 ) );
?>
```

以上例程的输出类似于：

    bool(false)
    bool(true)
    string(3) "two"
    bool(true)
    string(1) "5"

QuickHashIntStringHash::getSize
===============================

Returns the number of elements in the hash

### 说明

<span class="modifier">public</span> <span class="type">int</span> <span
class="methodname">QuickHashIntStringHash::getSize</span> ( <span
class="methodparam">void</span> )

Returns the number of elements in the hash.

### 返回值

The number of elements in the hash.

### 范例

**示例 \#1 <span class="function">QuickHashIntStringHash::getSize</span>
example**

``` php
<?php
$hash = new QuickHashIntStringHash( 8 );
var_dump( $hash->add( 2, "two" ) );
var_dump( $hash->add( 3, 5 ) );
var_dump( $hash->getSize() );
?>
```

以上例程的输出类似于：

    bool(true)
    bool(true)
    int(2)

QuickHashIntStringHash::loadFromFile
====================================

This factory method creates a hash from a file

### 说明

<span class="modifier">public</span> <span
class="modifier">static</span> <span
class="type">QuickHashIntStringHash</span> <span
class="methodname">QuickHashIntStringHash::loadFromFile</span> ( <span
class="methodparam"><span class="type">string</span> `$filename`</span>
\[, <span class="methodparam"><span class="type">int</span> `$size`<span
class="initializer"> = 0</span></span> \[, <span
class="methodparam"><span class="type">int</span> `$options`<span
class="initializer"> = 0</span></span> \]\] )

This factory method creates a new hash from a definition file on disk.
The file format consists of a signature 'QH\\0x12\\0', the number of
elements as a 32 bit signed integer in system Endianness, an unsigned 32
bit integer containing the number of element data to follow in
characters. This element data contains all the strings. After the header
and the strings, the elements follow in pairs of two unsigned 32 bit
integers where the first one is the key, and the second one the index in
the element data string. An example could be:

**示例 \#1 QuickHash IntString file format**

``` description
00000000  51 48 12 00 02 00 00 00  09 00 00 00 4f 4e 45 00  |QH..........ONE.|
00000010  4e 49 4e 45 00 01 00 00  00 00 00 00 00 03 00 00  |NINE............|
00000020  00 04 00 00 00                                    |.....|
00000025
```

**示例 \#2 QuickHash IntString file format**

``` description
header signature ('QH'; key type: 1; value type: 2; filler: \0x00)
00000000  51 48 12 00

number of elements:
00000004  02 00 00 00

length of string values (9 characters):
00000008  09 00 00 00

string values:
0000000C  4f 4e 45 00 4e 49 4e 45  00

data string:
00000015  01 00 00 00 00 00 00 00  03 00 00 00 04 00 00 00

key/value 1 (key = 1, string index = 0 ("ONE")):
01 00 00 00  00 00 00 00

key/value 2 (key = 3, string index = 4 ("NINE")):
03 00 00 00  04 00 00 00
```

### 参数

`filename`  
The filename of the file to read the hash from.

`size`  
The amount of bucket lists to configure. The number you pass in will be
automatically rounded up to the next power of two. It is also
automatically limited from 4 to 4194304.

`options`  
The same options that the class' constructor takes; except that the size
option is ignored. It is automatically calculated to be the same as the
number of entries in the hash, rounded up to the nearest power of two
with a maximum limit of 4194304.

### 返回值

Returns a new QuickHashIntStringHash.

### 范例

**示例 \#3 <span
class="function">QuickHashIntStringHash::loadFromFile</span> example**

``` php
<?php
$file = dirname( __FILE__ ) . "/simple.string.hash";
$hash = QuickHashIntStringHash::loadFromFile(
    $file,
    QuickHashIntStringHash::DO_NOT_USE_ZEND_ALLOC
);
foreach( range( 0, 0x0f ) as $key )
{
    printf( "Key %3d (%2x) is %s\n",
        $key, $key, 
        $hash->exists( $key ) ? 'set' : 'unset'
    );
}
?>
```

以上例程的输出类似于：

    Key   0 ( 0) is unset
    Key   1 ( 1) is set
    Key   2 ( 2) is set
    Key   3 ( 3) is set
    Key   4 ( 4) is unset
    Key   5 ( 5) is set
    Key   6 ( 6) is unset
    Key   7 ( 7) is set
    Key   8 ( 8) is unset
    Key   9 ( 9) is unset
    Key  10 ( a) is unset
    Key  11 ( b) is set
    Key  12 ( c) is unset
    Key  13 ( d) is set
    Key  14 ( e) is unset
    Key  15 ( f) is unset

QuickHashIntStringHash::loadFromString
======================================

This factory method creates a hash from a string

### 说明

<span class="modifier">public</span> <span
class="modifier">static</span> <span
class="type">QuickHashIntStringHash</span> <span
class="methodname">QuickHashIntStringHash::loadFromString</span> ( <span
class="methodparam"><span class="type">string</span> `$contents`</span>
\[, <span class="methodparam"><span class="type">int</span> `$size`<span
class="initializer"> = 0</span></span> \[, <span
class="methodparam"><span class="type">int</span> `$options`<span
class="initializer"> = 0</span></span> \]\] )

This factory method creates a new hash from a definition in a string.
The format is the same as the one used in "loadFromFile".

### 参数

`contents`  
The string containing a serialized format of the hash.

`size`  
The amount of bucket lists to configure. The number you pass in will be
automatically rounded up to the next power of two. It is also
automatically limited from 4 to 4194304.

`options`  
The same options that the class' constructor takes; except that the size
option is ignored. It is automatically calculated to be the same as the
number of entries in the hash, rounded up to the nearest power of two
with a maximum limit of 4194304.

### 返回值

Returns a new QuickHashIntStringHash.

### 范例

**示例 \#1 <span
class="function">QuickHashIntStringHash::loadFromString</span> example**

``` php
<?php
$contents = file_get_contents( dirname( __FILE__ ) . "/simple.hash" );
$hash = QuickHashIntStringHash::loadFromString(
    $contents,
    QuickHashIntStringHash::DO_NOT_USE_ZEND_ALLOC
);
foreach( range( 0, 0x0f ) as $key )
{
    printf( "Key %3d (%2x) is %s\n",
        $key, $key, 
        $hash->exists( $key ) ? 'set' : 'unset'
    );
}
?>
```

以上例程的输出类似于：

    Key   0 ( 0) is unset
    Key   1 ( 1) is set
    Key   2 ( 2) is set
    Key   3 ( 3) is set
    Key   4 ( 4) is unset
    Key   5 ( 5) is set
    Key   6 ( 6) is unset
    Key   7 ( 7) is set
    Key   8 ( 8) is unset
    Key   9 ( 9) is unset
    Key  10 ( a) is unset
    Key  11 ( b) is set
    Key  12 ( c) is unset
    Key  13 ( d) is set
    Key  14 ( e) is unset
    Key  15 ( f) is unset

QuickHashIntStringHash::saveToFile
==================================

This method stores an in-memory hash to disk

### 说明

<span class="modifier">public</span> <span class="type">void</span>
<span class="methodname">QuickHashIntStringHash::saveToFile</span> (
<span class="methodparam"><span class="type">string</span>
`$filename`</span> )

This method stores an existing hash to a file on disk, in the same
format that loadFromFile() can read.

### 参数

`filename`  
The filename of the file to store the hash in.

### 返回值

没有返回值。

### 范例

**示例 \#1 <span
class="function">QuickHashIntStringHash::saveToFile</span> example**

``` php
<?php
$hash = new QuickHashIntStringHash( 1024 );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->add( 4, "fourty three" ) );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->add( 4, "fifty two" ) );

$hash->saveToFile( '/tmp/test.string.hash' );
?>
```

QuickHashIntStringHash::saveToString
====================================

This method returns a serialized version of the hash

### 说明

<span class="modifier">public</span> <span class="type">string</span>
<span class="methodname">QuickHashIntStringHash::saveToString</span> (
<span class="methodparam">void</span> )

This method returns a serialized version of the hash in the same format
that loadFromString() can read.

### 返回值

This method returns a string containing a serialized format of the hash.
Each element is stored as a four byte value in the Endianness that the
current system uses.

### 范例

**示例 \#1 <span
class="function">QuickHashIntStringHash::saveToString</span> example**

``` php
<?php
$hash = new QuickHashIntStringHash( 1024 );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->add( 4, "thirty four" ) );
var_dump( $hash->exists( 4 ) );
var_dump( $hash->add( 5, "fifty five" ) );

var_dump( $hash->saveToString() );
?>
```

QuickHashIntStringHash::set
===========================

This method updates an entry in the hash with a new value, or adds a new
one if the entry doesn't exist

### 说明

<span class="modifier">public</span> <span class="type">int</span> <span
class="methodname">QuickHashIntStringHash::set</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> , <span
class="methodparam"><span class="type">string</span> `$value`</span> )

This method tries to update an entry with a new value. In case the entry
did not yet exist, it will instead add a new entry. It returns whether
the entry was added or update. If there are duplicate keys, only the
first found element will get an updated value. Use
QuickHashIntStringHash::CHECK\_FOR\_DUPES during hash creation to
prevent duplicate keys from being part of the hash.

### 参数

`key`  
The key of the entry to add or update.

`value`  
The value of the entry to add. If a non-string is passed, it will be
converted to a string automatically if possible.

### 返回值

2 if the entry was found and updated, 1 if the entry was newly added or
0 if there was an error.

### 范例

**示例 \#1 <span class="function">QuickHashIntStringHash::set</span>
example**

``` php
<?php
$hash = new QuickHashIntStringHash( 1024 );

echo "Set->Add\n";
var_dump( $hash->get( 46692 ) );
var_dump( $hash->set( 46692, "sixteen thousand ninety one" ) );
var_dump( $hash->get( 46692 ) );

echo "Set->Update\n";
var_dump( $hash->set( 46692, "twenty nine thousand nine hundred six" ) );
var_dump( $hash->get( 46692 ) );
?>
```

以上例程的输出类似于：

    Set->Add
    bool(false)
    int(2)
    string(27) "sixteen thousand ninety one"
    Set->Update
    int(1)
    string(37) "twenty nine thousand nine hundred six"

QuickHashIntStringHash::update
==============================

This method updates an entry in the hash with a new value

### 说明

<span class="modifier">public</span> <span class="type">bool</span>
<span class="methodname">QuickHashIntStringHash::update</span> ( <span
class="methodparam"><span class="type">int</span> `$key`</span> , <span
class="methodparam"><span class="type">string</span> `$value`</span> )

This method updates an entry with a new value, and returns whether the
entry was update. If there are duplicate keys, only the first found
element will get an updated value. Use
QuickHashIntStringHash::CHECK\_FOR\_DUPES during hash creation to
prevent duplicate keys from being part of the hash.

### 参数

`key`  
The key of the entry to add.

`value`  
The new value for the entry. If a non-string is passed, it will be
converted to a string automatically if possible.

### 返回值

**`TRUE`** when the entry was found and updated, and **`FALSE`** if the
entry was not part of the hash already.

### 范例

**示例 \#1 <span class="function">QuickHashIntStringHash::update</span>
example**

``` php
<?php
$hash->add( 161803398, "--" );
$hash->add( 314159265, "a lot" );

echo $hash->get( 161803398 ), "\n";
echo $hash->get( 314159265 ), "\n";

var_dump( $hash->update( 314159265, "a lot plus one" ) );
var_dump( $hash->update( 314159999, "a lot plus one" ) );

echo $hash->get( 161803398 ), "\n";
echo $hash->get( 314159265 ), "\n";
?>
```

以上例程的输出类似于：

    --
    a lot
    bool(true)
    bool(false)
    --
    a lot plus one
