参见
----

For further information on COM read the
<a href="https://docs.microsoft.com/windows/desktop/com/component-object-model--com--portal" class="link external">» COM specification</a>.
You might find some additional useful information in our FAQ for
<a href="/faq/com.html" class="xref">PHP 和 COM</a>. If you're thinking
of using MS Office applications on the server side, you should read the
information here:
<a href="http://support.microsoft.com/kb/257757" class="link external">» Considerations for Server-Side Automation of Office</a>.

com\_create\_guid
=================

Generate a globally unique identifier (GUID)

### 说明

<span class="type">string</span> <span
class="methodname">com\_create\_guid</span> ( <span
class="methodparam">void</span> )

Generates a Globally Unique Identifier (GUID).

A GUID is generated in the same way as DCE UUID's, except that the
Microsoft convention is to enclose a GUID in curly braces.

### 返回值

Returns the GUID as a string.

### 参见

-   <span class="function">uuid\_create</span> in the PECL uuid
    extension

com\_event\_sink
================

Connect events from a COM object to a PHP object

### 说明

<span class="type">bool</span> <span
class="methodname">com\_event\_sink</span> ( <span
class="methodparam"><span class="type">variant</span>
`$comobject`</span> , <span class="methodparam"><span
class="type">object</span> `$sinkobject`</span> \[, <span
class="methodparam"><span class="type">mixed</span>
`$sinkinterface`</span> \] )

Instructs COM to sink events generated by `comobject` into the PHP
object `sinkobject`.

Be careful how you use this feature; if you are doing something similar
to the example below, then it doesn't really make sense to run it in a
web server context.

### 参数

`comobject`  

`sinkobject`  
`sinkobject` should be an instance of a class with methods named after
those of the desired dispinterface; you may use <span
class="function">com\_print\_typeinfo</span> to help generate a template
class for this purpose.

`sinkinterface`  
PHP will attempt to use the default dispinterface type specified by the
typelibrary associated with `comobject`, but you may override this
choice by setting `sinkinterface` to the name of the dispinterface that
you want to use.

### 返回值

成功时返回 **`TRUE`**， 或者在失败时返回 **`FALSE`**。

### 范例

**示例 \#1 COM event sink example**

``` php
<?php
class IEEventSinker {
    var $terminated = false;

   function ProgressChange($progress, $progressmax) {
      echo "Download progress: $progress / $progressmax\n";
    }

    function DocumentComplete(&$dom, $url) {
      echo "Document $url complete\n";
    }

    function OnQuit() {
      echo "Quit!\n";
      $this->terminated = true;
    }
}
$ie = new COM("InternetExplorer.Application");
// note that you don't need the & for PHP 5!
$sink = new IEEventSinker();
com_event_sink($ie, $sink, "DWebBrowserEvents2");
$ie->Visible = true;
$ie->Navigate("http://www.example.org");
while(!$sink->terminated) {
  com_message_pump(4000);
}
$ie = null;
?>
```

### 参见

-   <span class="function">com\_print\_typeinfo</span>
-   <span class="function">com\_message\_pump</span>

com\_get\_active\_object
========================

Returns a handle to an already running instance of a COM object

### 说明

<span class="type">variant</span> <span
class="methodname">com\_get\_active\_object</span> ( <span
class="methodparam"><span class="type">string</span> `$progid`</span>
\[, <span class="methodparam"><span class="type">int</span>
`$code_page`</span> \] )

<span class="function">com\_get\_active\_object</span> is similar to
creating a new instance of a
<a href="/class/com.html" class="xref">com</a> object, except that it
will only return an object to your script if the object is already
running. OLE applications use something known as the "*Running Object
Table*" to allow well-known applications to be launched only once; this
function exposes the COM library function GetActiveObject() to get a
handle on a running instance.

### 参数

`progid`  
`progid` must be either the ProgID or CLSID for the object that you want
to access (for example *Word.Application*).

`code_page`  
Acts in precisely the same way that it does for the
<a href="/class/com.html" class="xref">com</a> class.

### 返回值

If the requested object is running, it will be returned to your script
just like any other COM object.

### 错误／异常

There are a variety of reasons why this function might fail, the most
common being that the object is not already running. In that situation,
the exception error code will be **`MK_E_UNAVAILABLE`**; you can use the
*getCode* method of the exception object to check the exception code.

### 注释

**Warning**

Using <span class="function">com\_get\_active\_object</span> in a web
server context is not always a smart idea. Most COM/OLE applications are
not designed to handle more than one client concurrently, even (or
especially!) Microsoft Office. You should read
<a href="http://support.microsoft.com/kb/257757" class="link external">» Considerations for Server-Side Automation of Office</a>
for more information on the general issues involved.

com\_load\_typelib
==================

装载一个 Typelib

### 说明

<span class="type">bool</span> <span
class="methodname">com\_load\_typelib</span> ( <span
class="methodparam"><span class="type">string</span>
`$typelib_name`</span> \[, <span class="methodparam"><span
class="type">bool</span> `$case_insensitive`<span class="initializer"> =
true</span></span> \] )

Loads a type-library and registers its constants in the engine, as
though they were defined using <span class="function">define</span>.

Note that it is much more efficient to use the
<a href="/com/setup.html#" class="xref"></a> configuration setting to
pre-load and register the constants, although not so flexible.

If you have turned on <a href="/com/setup.html#" class="xref"></a>, then
PHP will attempt to automatically register the constants associated with
a COM object when you instantiate it. This depends on the interfaces
provided by the COM object itself, and may not always be possible.

### 参数

`typelib_name`  
`typelib_name` can be one of the following:

-   The filename of a *.tlb* file or the executable module that contains
    the type library.

-   The type library GUID, followed by its version number, for example
    *{00000200-0000-0010-8000-00AA006D2EA4},2,0*.

-   The type library name, e.g. *Microsoft OLE DB ActiveX Data Objects
    1.0 Library*.

PHP will attempt to resolve the type library in this order, as the
process gets more and more expensive as you progress down the list;
searching for the type library by name is handled by physically
enumerating the registry until we find a match.

`case_insensitive`  
The `case_insensitive` behaves in the same way as the parameter with the
same name in the <span class="function">define</span> function.

### 返回值

成功时返回 **`TRUE`**， 或者在失败时返回 **`FALSE`**。

com\_message\_pump
==================

Process COM messages, sleeping for up to timeoutms milliseconds

### 说明

<span class="type">bool</span> <span
class="methodname">com\_message\_pump</span> (\[ <span
class="methodparam"><span class="type">int</span> `$timeoutms`<span
class="initializer"> = 0</span></span> \] )

This function will sleep for up to `timeoutms` milliseconds, or until a
message arrives in the queue.

The purpose of this function is to route COM calls between apartments
and handle various synchronization issues. This allows your script to
wait efficiently for events to be triggered, while still handling other
events or running other code in the background. You should use it in a
loop, as demonstrated by the example in the <span
class="function">com\_event\_sink</span> function, until you are
finished using event bound COM objects.

### 参数

`timeoutms`  
The timeout, in milliseconds.

If you do not specify a value for `timeoutms`, then 0 will be assumed. A
0 value means that no waiting will be performed; if there are messages
pending they will be dispatched as before; if there are no messages
pending, the function will return **`FALSE`** immediately without
sleeping.

### 返回值

If a message or messages arrives before the timeout, they will be
dispatched, and the function will return **`TRUE`**. If the timeout
occurs and no messages were processed, the return value will be
**`FALSE`**.

com\_print\_typeinfo
====================

Print out a PHP class definition for a dispatchable interface

### 说明

<span class="type">bool</span> <span
class="methodname">com\_print\_typeinfo</span> ( <span
class="methodparam"><span class="type">object</span> `$comobject`</span>
\[, <span class="methodparam"><span class="type">string</span>
`$dispinterface`<span class="initializer"> = **`NULL`**</span></span>
\[, <span class="methodparam"><span class="type">bool</span>
`$wantsink`<span class="initializer"> = **`FALSE`**</span></span> \]\] )

The purpose of this function is to help generate a skeleton class for
use as an event sink. You may also use it to generate a dump of any COM
object, provided that it supports enough of the introspection
interfaces, and that you know the name of the interface you want to
display.

### 参数

`comobject`  
`comobject` should be either an instance of a COM object, or be the name
of a typelibrary (which will be resolved according to the rules set out
in <span class="function">com\_load\_typelib</span>).

`dispinterface`  
The name of an *IDispatch* descendant interface that you want to
display.

`wantsink`  
If set to **`TRUE`**, the corresponding sink interface will be displayed
instead.

### 返回值

成功时返回 **`TRUE`**， 或者在失败时返回 **`FALSE`**。

### 参见

-   <span class="function">com\_event\_sink</span>
-   <span class="function">com\_load\_typelib</span>

variant\_abs
============

Returns the absolute value of a variant

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_abs</span> ( <span class="methodparam"><span
class="type">mixed</span> `$val`</span> )

Returns the absolute value of a variant.

### 参数

`val`  
The variant.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

Returns the absolute value of `val`.

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

### 参见

-   <span class="function">abs</span>

variant\_add
============

"Adds" two variant values together and returns the result

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_add</span> ( <span class="methodparam"><span
class="type">mixed</span> `$left`</span> , <span
class="methodparam"><span class="type">mixed</span> `$right`</span> )

Adds `left` to `right` using the following rules (taken from the MSDN
library), which correspond to those of Visual Basic:

| If                                                        | Then                        |
|-----------------------------------------------------------|-----------------------------|
| Both expressions are of the string type                   | Concatenation               |
| One expression is a string type and the other a character | Addition                    |
| One expression is numeric and the other is a string       | Addition                    |
| Both expressions are numeric                              | Addition                    |
| Either expression is NULL                                 | NULL is returned            |
| Both expressions are empty                                | Integer subtype is returned |

### 参数

`left`  
The left operand.

`right`  
The right operand.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

Returns the result.

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

### 参见

-   <span class="function">variant\_sub</span>

variant\_and
============

Performs a bitwise AND operation between two variants

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_and</span> ( <span class="methodparam"><span
class="type">mixed</span> `$left`</span> , <span
class="methodparam"><span class="type">mixed</span> `$right`</span> )

Performs a bitwise AND operation. Note that this is slightly different
from a regular AND operation.

### 参数

`left`  
The left operand.

`right`  
The right operand.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

| If `left` is | If `right` is | then the result is |
|--------------|---------------|--------------------|
| **`TRUE`**   | **`TRUE`**    | **`TRUE`**         |
| **`TRUE`**   | **`FALSE`**   | **`FALSE`**        |
| **`TRUE`**   | **`NULL`**    | **`NULL`**         |
| **`FALSE`**  | **`TRUE`**    | **`FALSE`**        |
| **`FALSE`**  | **`FALSE`**   | **`FALSE`**        |
| **`FALSE`**  | **`NULL`**    | **`FALSE`**        |
| **`NULL`**   | **`TRUE`**    | **`NULL`**         |
| **`NULL`**   | **`FALSE`**   | **`FALSE`**        |
| **`NULL`**   | **`NULL`**    | **`NULL`**         |

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

### 参见

-   <span class="function">variant\_or</span>

variant\_cast
=============

Convert a variant into a new variant object of another type

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_cast</span> ( <span
class="methodparam"><span class="type">variant</span> `$variant`</span>
, <span class="methodparam"><span class="type">int</span> `$type`</span>
)

This function makes a copy of `variant` and then performs a variant cast
operation to force the copy to have the type given by `type`.

This function wraps VariantChangeType() in the COM library; consult MSDN
for more information.

### 参数

`variant`  
The variant.

`type`  
`type` should be one of the **`VT_XXX`** constants.

### 返回值

Returns a variant of given `type`.

### 参见

-   <span class="function">variant\_set\_type</span>

variant\_cat
============

Concatenates two variant values together and returns the result

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_cat</span> ( <span class="methodparam"><span
class="type">mixed</span> `$left`</span> , <span
class="methodparam"><span class="type">mixed</span> `$right`</span> )

Concatenates `left` with `right` and returns the result.

This function is notionally equivalent to `$left` *.* `$right`.

### 参数

`left`  
The left operand.

`right`  
The right operand.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

Returns the result of the concatenation.

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

### 参见

-   <a href="/language/operators/string.html" class="xref">字符串运算符</a>
    for the string concatenation operator

variant\_cmp
============

Compares two variants

### 说明

<span class="type">int</span> <span
class="methodname">variant\_cmp</span> ( <span class="methodparam"><span
class="type">mixed</span> `$left`</span> , <span
class="methodparam"><span class="type">mixed</span> `$right`</span> \[,
<span class="methodparam"><span class="type">int</span> `$lcid`</span>
\[, <span class="methodparam"><span class="type">int</span>
`$flags`</span> \]\] )

Compares `left` with `right`.

This function will only compare scalar values, not arrays or variant
records.

### 参数

`left`  
The left operand.

`right`  
The right operand.

`lcid`  
A valid Locale Identifier to use when comparing strings (this affects
string collation).

`flags`  
`flags` can be one or more of the following values OR'd together, and
affects string comparisons:

| value                     | meaning                          |
|---------------------------|----------------------------------|
| **`NORM_IGNORECASE`**     | Compare case insensitively       |
| **`NORM_IGNORENONSPACE`** | Ignore nonspacing characters     |
| **`NORM_IGNORESYMBOLS`**  | Ignore symbols                   |
| **`NORM_IGNOREWIDTH`**    | Ignore string width              |
| **`NORM_IGNOREKANATYPE`** | Ignore Kana type                 |
| **`NORM_IGNOREKASHIDA`**  | Ignore Arabic kashida characters |

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

Returns one of the following:

| value             | meaning                                       |
|-------------------|-----------------------------------------------|
| **`VARCMP_LT`**   | `left` is less than `right`                   |
| **`VARCMP_EQ`**   | `left` is equal to `right`                    |
| **`VARCMP_GT`**   | `left` is greater than `right`                |
| **`VARCMP_NULL`** | Either `left`, `right` or both are **`NULL`** |

variant\_date\_from\_timestamp
==============================

Returns a variant date representation of a Unix timestamp

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_date\_from\_timestamp</span> ( <span
class="methodparam"><span class="type">int</span> `$timestamp`</span> )

Converts `timestamp` from a unix timestamp value into a variant of type
**`VT_DATE`**. This allows easier interopability between the unix-ish
parts of PHP and COM.

### 参数

`timestamp`  
A unix timestamp.

### 返回值

Returns a **`VT_DATE`** variant.

### 参见

-   <span class="function">variant\_date\_to\_timestamp</span>
-   <span class="function">mktime</span>
-   <span class="function">time</span>

variant\_date\_to\_timestamp
============================

Converts a variant date/time value to Unix timestamp

### 说明

<span class="type">int</span> <span
class="methodname">variant\_date\_to\_timestamp</span> ( <span
class="methodparam"><span class="type">variant</span> `$variant`</span>
)

Converts `variant` from a **`VT_DATE`** (or similar) value into a Unix
timestamp. This allows easier interopability between the Unix-ish parts
of PHP and COM.

### 参数

`variant`  
The variant.

### 返回值

Returns a unix timestamp.

### 参见

-   <span class="function">variant\_date\_from\_timestamp</span>
-   <span class="function">date</span>
-   <span class="function">strftime</span>

variant\_div
============

Returns the result from dividing two variants

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_div</span> ( <span class="methodparam"><span
class="type">mixed</span> `$left`</span> , <span
class="methodparam"><span class="type">mixed</span> `$right`</span> )

Divides `left` by `right` and returns the result.

### 参数

`left`  
The left operand.

`right`  
The right operand.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

| If                                                                | Then                                                                                       |
|-------------------------------------------------------------------|--------------------------------------------------------------------------------------------|
| Both expressions are of the string, date, character, boolean type | Double is returned                                                                         |
| One expression is a string type and the other a character         | Division and a double is returned                                                          |
| One expression is numeric and the other is a string               | Division and a double is returned.                                                         |
| Both expressions are numeric                                      | Division and a double is returned                                                          |
| Either expression is NULL                                         | NULL is returned                                                                           |
| `right` is empty and `left` is anything but empty                 | A <span class="classname">com\_exception</span> with code **`DISP_E_DIVBYZERO`** is thrown |
| `left` is empty and `right` is anything but empty.                | 0 as type double is returned                                                               |
| Both expressions are empty                                        | A <span class="classname">com\_exception</span> with code **`DISP_E_OVERFLOW`** is thrown  |

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

### 参见

-   <span class="function">variant\_idiv</span>

variant\_eqv
============

Performs a bitwise equivalence on two variants

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_eqv</span> ( <span class="methodparam"><span
class="type">mixed</span> `$left`</span> , <span
class="methodparam"><span class="type">mixed</span> `$right`</span> )

Performs a bitwise equivalence on two variants.

### 参数

`left`  
The left operand.

`right`  
The right operand.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

If each bit in `left` is equal to the corresponding bit in `right` then
**`TRUE`** is returned, otherwise **`FALSE`** is returned.

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

variant\_fix
============

Returns the integer portion of a variant

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_fix</span> ( <span class="methodparam"><span
class="type">mixed</span> `$variant`</span> )

Gets the integer portion of a variant.

### 参数

`variant`  
The variant.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

If `variant` is negative, then the first negative integer greater than
or equal to the variant is returned, otherwise returns the integer
portion of the value of `variant`.

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

### 注释

**Warning**

This documentation is based on the MSDN documentation; it appears that
this function is either the same as <span
class="function">variant\_int</span>, or that there is an error in the
MSDN documentation.

### 参见

-   <span class="function">variant\_int</span>
-   <span class="function">variant\_round</span>
-   <span class="function">floor</span>
-   <span class="function">ceil</span>
-   <span class="function">round</span>

variant\_get\_type
==================

Returns the type of a variant object

### 说明

<span class="type">int</span> <span
class="methodname">variant\_get\_type</span> ( <span
class="methodparam"><span class="type">variant</span> `$variant`</span>
)

Returns the type of a variant object.

### 参数

`variant`  
The variant object.

### 返回值

This function returns an integer value that indicates the type of
`variant`, which can be an instance of
<a href="/class/com.html" class="xref">com</a>,
<a href="/class/dotnet.html" class="xref">dotnet</a> or
<a href="/class/variant.html" class="xref">variant</a> classes. The
return value can be compared to one of the **`VT_XXX`** constants.

The return value for COM and DOTNET objects will usually be
**`VT_DISPATCH`**; the only reason this function works for those classes
is because COM and DOTNET are descendants of VARIANT.

### 参见

-   <span class="function">variant\_set\_type</span>

variant\_idiv
=============

Converts variants to integers and then returns the result from dividing
them

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_idiv</span> ( <span
class="methodparam"><span class="type">mixed</span> `$left`</span> ,
<span class="methodparam"><span class="type">mixed</span>
`$right`</span> )

Converts `left` and `right` to integer values, and then performs integer
division.

### 参数

`left`  
The left operand.

`right`  
The right operand.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

| If                                                                | Then                                                                                       |
|-------------------------------------------------------------------|--------------------------------------------------------------------------------------------|
| Both expressions are of the string, date, character, boolean type | Division and integer is returned                                                           |
| One expression is a string type and the other a character         | Division                                                                                   |
| One expression is numeric and the other is a string               | Division                                                                                   |
| Both expressions are numeric                                      | Division                                                                                   |
| Either expression is NULL                                         | NULL is returned                                                                           |
| Both expressions are empty                                        | A <span class="classname">com\_exception</span> with code **`DISP_E_DIVBYZERO`** is thrown |

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

### 参见

-   <span class="function">variant\_div</span>

variant\_imp
============

Performs a bitwise implication on two variants

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_imp</span> ( <span class="methodparam"><span
class="type">mixed</span> `$left`</span> , <span
class="methodparam"><span class="type">mixed</span> `$right`</span> )

Performs a bitwise implication operation.

### 参数

`left`  
The left operand.

`right`  
The right operand.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

| If `left` is | If `right` is | then the result is |
|--------------|---------------|--------------------|
| **`TRUE`**   | **`TRUE`**    | **`TRUE`**         |
| **`TRUE`**   | **`FALSE`**   | **`FALSE`**        |
| **`TRUE`**   | **`NULL`**    | **`TRUE`**         |
| **`FALSE`**  | **`TRUE`**    | **`TRUE`**         |
| **`FALSE`**  | **`FALSE`**   | **`TRUE`**         |
| **`FALSE`**  | **`NULL`**    | **`TRUE`**         |
| **`NULL`**   | **`TRUE`**    | **`TRUE`**         |
| **`NULL`**   | **`FALSE`**   | **`NULL`**         |
| **`NULL`**   | **`NULL`**    | **`NULL`**         |

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

variant\_int
============

Returns the integer portion of a variant

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_int</span> ( <span class="methodparam"><span
class="type">mixed</span> `$variant`</span> )

Gets the integer portion of a variant.

### 参数

`variant`  
The variant.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

If `variant` is negative, then the first negative integer greater than
or equal to the variant is returned, otherwise returns the integer
portion of the value of `variant`.

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

### 参见

-   <span class="function">variant\_fix</span>
-   <span class="function">variant\_round</span>
-   <span class="function">floor</span>
-   <span class="function">ceil</span>
-   <span class="function">round</span>

variant\_mod
============

Divides two variants and returns only the remainder

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_mod</span> ( <span class="methodparam"><span
class="type">mixed</span> `$left`</span> , <span
class="methodparam"><span class="type">mixed</span> `$right`</span> )

Divides `left` by `right` and returns the remainder.

### 参数

`left`  
The left operand.

`right`  
The right operand.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

Returns the remainder of the division.

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

### 参见

-   <span class="function">variant\_div</span>
-   <span class="function">variant\_idiv</span>

variant\_mul
============

Multiplies the values of the two variants

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_mul</span> ( <span class="methodparam"><span
class="type">mixed</span> `$left`</span> , <span
class="methodparam"><span class="type">mixed</span> `$right`</span> )

Multiplies `left` by `right`.

### 参数

`left`  
The left operand.

`right`  
The right operand.

Boolean values are converted to -1 for **`FALSE`** and 0 for **`TRUE`**.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

| If                                                                | Then                     |
|-------------------------------------------------------------------|--------------------------|
| Both expressions are of the string, date, character, boolean type | Multiplication           |
| One expression is a string type and the other a character         | Multiplication           |
| One expression is numeric and the other is a string               | Multiplication           |
| Both expressions are numeric                                      | Multiplication           |
| Either expression is NULL                                         | NULL is returned         |
| Both expressions are empty                                        | Empty string is returned |

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

### 参见

-   <span class="function">variant\_div</span>
-   <span class="function">variant\_idiv</span>

variant\_neg
============

Performs logical negation on a variant

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_neg</span> ( <span class="methodparam"><span
class="type">mixed</span> `$variant`</span> )

Performs logical negation of `variant`.

### 参数

`variant`  
The variant.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

Returns the result of the logical negation.

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

variant\_not
============

Performs bitwise not negation on a variant

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_not</span> ( <span class="methodparam"><span
class="type">mixed</span> `$variant`</span> )

Performs bitwise not negation on `variant` and returns the result.

### 参数

`variant`  
The variant.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

Returns the bitwise not negation. If `variant` is **`NULL`**, the result
will also be **`NULL`**.

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

variant\_or
===========

Performs a logical disjunction on two variants

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_or</span> ( <span class="methodparam"><span
class="type">mixed</span> `$left`</span> , <span
class="methodparam"><span class="type">mixed</span> `$right`</span> )

Performs a bitwise OR operation. Note that this is slightly different
from a regular OR operation.

### 参数

`left`  
The left operand.

`right`  
The right operand.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

| If `left` is | If `right` is | then the result is |
|--------------|---------------|--------------------|
| **`TRUE`**   | **`TRUE`**    | **`TRUE`**         |
| **`TRUE`**   | **`FALSE`**   | **`TRUE`**         |
| **`TRUE`**   | **`NULL`**    | **`TRUE`**         |
| **`FALSE`**  | **`TRUE`**    | **`TRUE`**         |
| **`FALSE`**  | **`FALSE`**   | **`FALSE`**        |
| **`FALSE`**  | **`NULL`**    | **`NULL`**         |
| **`NULL`**   | **`TRUE`**    | **`TRUE`**         |
| **`NULL`**   | **`FALSE`**   | **`NULL`**         |
| **`NULL`**   | **`NULL`**    | **`NULL`**         |

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

### 参见

-   <span class="function">variant\_and</span>
-   <span class="function">variant\_xor</span>

variant\_pow
============

Returns the result of performing the power function with two variants

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_pow</span> ( <span class="methodparam"><span
class="type">mixed</span> `$left`</span> , <span
class="methodparam"><span class="type">mixed</span> `$right`</span> )

Returns the result of `left` to the power of `right`.

### 参数

`left`  
The left operand.

`right`  
The right operand.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

Returns the result of `left` to the power of `right`.

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

### 参见

-   <span class="function">pow</span>

variant\_round
==============

Rounds a variant to the specified number of decimal places

### 说明

<span class="type">mixed</span> <span
class="methodname">variant\_round</span> ( <span
class="methodparam"><span class="type">mixed</span> `$variant`</span> ,
<span class="methodparam"><span class="type">int</span>
`$decimals`</span> )

Returns the value of `variant` rounded to `decimals` decimal places.

### 参数

`variant`  
The variant.

`decimals`  
Number of decimal places.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

Returns the rounded value.

### 参见

-   <span class="function">round</span>

variant\_set\_type
==================

Convert a variant into another type "in-place"

### 说明

<span class="type">void</span> <span
class="methodname">variant\_set\_type</span> ( <span
class="methodparam"><span class="type">variant</span> `$variant`</span>
, <span class="methodparam"><span class="type">int</span> `$type`</span>
)

This function is similar to <span class="function">variant\_cast</span>
except that the variant is modified "in-place"; no new variant is
created. The parameters for this function have identical meaning to
those of <span class="function">variant\_cast</span>.

### 参数

`variant`  
The variant.

`type`  

### 返回值

没有返回值。

### 参见

-   <span class="function">variant\_cast</span>
-   <span class="function">variant\_get\_type</span>

variant\_set
============

Assigns a new value for a variant object

### 说明

<span class="type">void</span> <span
class="methodname">variant\_set</span> ( <span class="methodparam"><span
class="type">variant</span> `$variant`</span> , <span
class="methodparam"><span class="type">mixed</span> `$value`</span> )

Converts `value` to a variant and assigns it to the `variant` object; no
new variant object is created, and the old value of `variant` is
freed/released.

### 参数

`variant`  
The variant.

`value`  

### 返回值

没有返回值。

variant\_sub
============

Subtracts the value of the right variant from the left variant value

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_sub</span> ( <span class="methodparam"><span
class="type">mixed</span> `$left`</span> , <span
class="methodparam"><span class="type">mixed</span> `$right`</span> )

Subtracts `right` from `left`.

### 参数

`left`  
The left operand.

`right`  
The right operand.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

| If                                                        | Then                     |
|-----------------------------------------------------------|--------------------------|
| Both expressions are of the string type                   | Subtraction              |
| One expression is a string type and the other a character | Subtraction              |
| One expression is numeric and the other is a string       | Subtraction.             |
| Both expressions are numeric                              | Subtraction              |
| Either expression is NULL                                 | NULL is returned         |
| Both expressions are empty                                | Empty string is returned |

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

### 参见

-   <span class="function">variant\_add</span>

variant\_xor
============

Performs a logical exclusion on two variants

### 说明

<span class="type">variant</span> <span
class="methodname">variant\_xor</span> ( <span class="methodparam"><span
class="type">mixed</span> `$left`</span> , <span
class="methodparam"><span class="type">mixed</span> `$right`</span> )

Performs a logical exclusion.

### 参数

`left`  
The left operand.

`right`  
The right operand.

> **Note**:
>
> 对于所有变量运算函数，本函数的参数可以是 PHP
> 内置的类型（整数，字符串，浮点数，布尔型或者 **`NULL`**），或者是一个
> COM，VARIANT 或者 DOTNET 类的实例。PHP
> 内置类型将会使用和构造<a href="/class/variant.html" class="xref">variant</a>类相同的规则转换成变量。COM
> 和 DOTNET 对象的值将会取其默认属性并被当成变量值使用。
>
> 变量运算函数是同名函数在 COM 库中的外包；有关此类函数的更多信息参见
> MSDN 库。PHP 函数命名有少许区别，例如 PHP 中的 <span
> class="function">variant\_add</span> 对应于 MSDN 文档中的 *VarAdd()*。

### 返回值

| If `left` is | If `right` is | then the result is |
|--------------|---------------|--------------------|
| **`TRUE`**   | **`TRUE`**    | **`FALSE`**        |
| **`TRUE`**   | **`FALSE`**   | **`TRUE`**         |
| **`FALSE`**  | **`TRUE`**    | **`TRUE`**         |
| **`FALSE`**  | **`FALSE`**   | **`FALSE`**        |
| **`NULL`**   | **`NULL`**    | **`NULL`**         |

### 错误／异常

Throws a <span class="classname">com\_exception</span> on failure.

### 参见

-   <span class="function">variant\_or</span>
-   <span class="function">variant\_and</span>

**目录**

-   [com\_create\_guid](/ref/com.html#com_create_guid) — Generate a
    globally unique identifier (GUID)
-   [com\_event\_sink](/ref/com.html#com_event_sink) — Connect events
    from a COM object to a PHP object
-   [com\_get\_active\_object](/ref/com.html#com_get_active_object) —
    Returns a handle to an already running instance of a COM object
-   [com\_load\_typelib](/ref/com.html#com_load_typelib) — 装载一个
    Typelib
-   [com\_message\_pump](/ref/com.html#com_message_pump) — Process COM
    messages, sleeping for up to timeoutms milliseconds
-   [com\_print\_typeinfo](/ref/com.html#com_print_typeinfo) — Print out
    a PHP class definition for a dispatchable interface
-   [variant\_abs](/ref/com.html#variant_abs) — Returns the absolute
    value of a variant
-   [variant\_add](/ref/com.html#variant_add) — "Adds" two variant
    values together and returns the result
-   [variant\_and](/ref/com.html#variant_and) — Performs a bitwise AND
    operation between two variants
-   [variant\_cast](/ref/com.html#variant_cast) — Convert a variant into
    a new variant object of another type
-   [variant\_cat](/ref/com.html#variant_cat) — Concatenates two variant
    values together and returns the result
-   [variant\_cmp](/ref/com.html#variant_cmp) — Compares two variants
-   [variant\_date\_from\_timestamp](/ref/com.html#variant_date_from_timestamp)
    — Returns a variant date representation of a Unix timestamp
-   [variant\_date\_to\_timestamp](/ref/com.html#variant_date_to_timestamp)
    — Converts a variant date/time value to Unix timestamp
-   [variant\_div](/ref/com.html#variant_div) — Returns the result from
    dividing two variants
-   [variant\_eqv](/ref/com.html#variant_eqv) — Performs a bitwise
    equivalence on two variants
-   [variant\_fix](/ref/com.html#variant_fix) — Returns the integer
    portion of a variant
-   [variant\_get\_type](/ref/com.html#variant_get_type) — Returns the
    type of a variant object
-   [variant\_idiv](/ref/com.html#variant_idiv) — Converts variants to
    integers and then returns the result from dividing them
-   [variant\_imp](/ref/com.html#variant_imp) — Performs a bitwise
    implication on two variants
-   [variant\_int](/ref/com.html#variant_int) — Returns the integer
    portion of a variant
-   [variant\_mod](/ref/com.html#variant_mod) — Divides two variants and
    returns only the remainder
-   [variant\_mul](/ref/com.html#variant_mul) — Multiplies the values of
    the two variants
-   [variant\_neg](/ref/com.html#variant_neg) — Performs logical
    negation on a variant
-   [variant\_not](/ref/com.html#variant_not) — Performs bitwise not
    negation on a variant
-   [variant\_or](/ref/com.html#variant_or) — Performs a logical
    disjunction on two variants
-   [variant\_pow](/ref/com.html#variant_pow) — Returns the result of
    performing the power function with two variants
-   [variant\_round](/ref/com.html#variant_round) — Rounds a variant to
    the specified number of decimal places
-   [variant\_set\_type](/ref/com.html#variant_set_type) — Convert a
    variant into another type "in-place"
-   [variant\_set](/ref/com.html#variant_set) — Assigns a new value for
    a variant object
-   [variant\_sub](/ref/com.html#variant_sub) — Subtracts the value of
    the right variant from the left variant value
-   [variant\_xor](/ref/com.html#variant_xor) — Performs a logical
    exclusion on two variants
